"use strict";$(document).ready(function(){n(),$("#PasswordVisible").click(function(){toggleVisiblePassword("#PasswordVisible","#registerPassword")}),$("#ConfirmPasswordVisible").click(function(){toggleVisiblePassword("#ConfirmPasswordVisible","#passwordConfirm")}),$("#editPasswordVisible").click(function(){toggleVisiblePassword("#editPasswordVisible","#editPassword")}),$("#editConfirmPasswordVisible").click(function(){toggleVisiblePassword("#editConfirmPasswordVisible","#editPasswordConfirm")});var l=!1;$("#passwordConfirm, #registerPassword").on("input focusout",function(){var e=$("#registerPassword").val(),a=$("#passwordConfirm").val();l=e!=a?(notValidInput("#passwordConfirm","#passwordConfirmValidate","Password is not matched"),!1):""==e?(notValidInput("#passwordConfirm","#passwordConfirmValidate","Password is empty"),!1):(validInput("#passwordConfirm","#passwordConfirmValidate"),!0)});var r=!0;function n(){$.ajax({type:"POST",url:"./backend/login/userOperation.php",data:{postType:"view"},beforeLoad:function(){$("#report-table").append('<div class="d-flex justify-content-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div>')},success:function(e){e&&"0 results"!=e&&(e=e.includes("Success")?JSON.parse(e.replace("Success","")):JSON.parse(e),$("#report-table").empty(),$("#report-table").append('<table id="userTable" class="table table-hover table-bordered text-center " cellspacing="0" width="100%">  <thead class="grey lighten-2">  <tr>  <th scope="col">#</th>  <th scope="col" class="th-lg">Username</th>  <th scope="col">User Role</th>  <th scope="col">Contact No</th>  <th scope="col">Email</th>  <th scope="col">Login Attempt</th>  <th scope="col">Status</th>  <th scope="col" class="text-center th-lg">Action</th>  </tr>  </thead>  <tbody id="content">  </tbody>  <tfoot class="grey lighten-2">  <tr>  <th scope="col">#</th>  <th scope="col" class="th-lg">Username</th>  <th scope="col">User Role</th>  <th scope="col">Contact No</th>  <th scope="col">Email</th>  <th scope="col">Login Attempt</th>  <th scope="col">Status</th>  <th scope="col" class="text-center th-lg">Action</th>  </tr>  </tfoot>  </table>'),$.each(e,function(e,a){e++,$("#content").append('<tr> <th scope="row">'+e+"</th><td id='username-"+e+"'>"+a.username+' </td> <td id="role-'+e+'"> '+a.role+' </td> <td id="contactno-'+e+'"> '+a.contact_num+' </td> <td id="email-'+e+'"> '+a.email+' </td> <td id="login-'+e+'"> '+a.login_attempt+' </td> <td id="status-'+e+'"> '+a.status+' </td> <td> <button id="edit-'+e+'" class="btn btn-info editBtn py-md-3 px-md-4 p-sm-3" data-toggle="modal" data-target="#editModal"> <span class="textBreak">Edit</span> <span class="iconBreak"><i class="fas fa-user-edit"></i></span> </button> <button id="delete-'+e+'" class="btn btn-warning deleteBtn py-md-3 px-md-4 p-sm-3" data-toggle="modal" data-target="#deleteModal"> <span class="textBreak">Delete</span> <span class="iconBreak"><i class="fas fa-user-minus"></i></span> </button> </td>  </tr>')}),$("#userTable").dataTable({paging:!0,scrollX:!0,scrollY:"800px",scrollCollapse:!0,lengthMenu:[[-1,50,25,10],["All",50,25,10]]}),$(".dataTables_length").addClass("bs-select"),$(".editBtn").click(function(){var e=$(this).attr("id").split("-");$("#editUsername").val($("#username-"+e[1]).text().trim()),$("#editLoginAttempt").val($("#login-"+e[1]).text().trim()),$("#editRole").val($("#role-"+e[1]).text().trim()),$("#editEmail").val($("#email-"+e[1]).text().trim()),$("#editContact").val($("#contactno-"+e[1]).text().trim()),$("#editStatus").val(""==$("#status-"+e[1]).text().trim()?"active":$("#status-"+e[1]).text().trim())}),$(".deleteBtn").click(function(){var e=$(this).attr("id").split("-");$("#deleteUserName").text($("#username-"+e[1]).text().trim())}))},error:function(){console.log("Failed")}})}useOldPassword("#editPasswordConfirm","#editPasswordConfirmValidate"),useOldPassword("#editPassword","#editPasswordValidate"),$("#editPasswordConfirm, #editPassword").on("input focusout",function(){var e=$("#editPassword").val(),a=$("#editPasswordConfirm").val();r=""!=e&&""!=a?e!=a?(notValidInput("#editPasswordConfirm","#editPasswordConfirmValidate","Password is not matched"),!1):(validInput("#editPasswordConfirm","#editPasswordConfirmValidate"),!0):""==e&&""!=a?(notValidInput("#editPasswordConfirm","#editPasswordConfirmValidate","Password is empty"),!1):""==a&&""!=e?(notValidInput("#editPasswordConfirm","#editPasswordConfirmValidate","Confirm Password is empty"),!1):(useOldPassword("#editPasswordConfirm","#editPasswordConfirmValidate"),useOldPassword("#editPassword","#editPasswordValidate"),!0)}),$(".nevermind").click(function(){$(".form-control").val("")}),$("#menu-toggle").click(function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled")}),$(".list-group-item-action").click(function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled")}),$("#addUserSubmitBtn").click(function(){var e=$("#registerUsername").val(),a=$("#registerPassword").val(),t=$("#registerRole").val(),s=$("#registerEmail").val(),d=$("#registerContact").val(),o=$("#registerStatus").val();""!=a&&""!=e&&""!=s&&""!=d?l?$.ajax({type:"POST",url:"./backend/login/userOperation.php",data:{postType:"add",username:e,role:t,email:s,contact_num:d,password:a,status:o},beforeLoad:function(){$("#report-table").append('<div class="d-flex justify-content-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div>')},success:function(e){switch(e){case"Success":$("#userTable").dataTable({bDestroy:!0}),n(),$("#addModal").modal("hide"),$("#registerUsername").val(""),$("#registerPassword").val(""),$("#passwordConfirm").val(""),$("#registerEmail").val(""),$("#registerContact").val(""),$("#passwordConfirm").removeClass("is-valid"),$("#passwordConfirmValidate").removeClass("valid-feedback").empty(),$("#successModalHeadline").empty().append("New User Added"),$("#successModalBody").empty().append("A New User is successfully added."),$("#successToModal").modal("show");break;case"Username Already Existed":$("#failedModalHeadline").empty().append("Failed to Add User"),$("#failedModalBody").empty().append("Username have been used already"),$("#failedToModal").modal("show")}},error:function(){$("#addModal").modal("hide"),$("#failedModalHeadline").empty().append("Failed to Add User"),$("#failedModalBody").empty().append("Add New User Process Failed."),$("#failedToModal").modal("show")}}):($("#failedModalHeadline").empty().append("Failed to Add User"),$("#failedModalBody").empty().append("Your password is not matched with Confirm Password"),$("#failedToModal").modal("show")):($("#failedModalHeadline").empty().append("Failed to Add User"),$("#failedModalBody").empty().append("Please fill up all the required fields"),$("#failedToModal").modal("show"))}),$("#editeUserSubmitButton").click(function(){var a=$("#editUsername").val(),e=$("#editPassword").val(),t=$("#editEmail").val(),s=$("#editContact").val(),d=$("#editPasswordConfirm").val(),o=$("#editLoginAttempt").val(),l=$("#editRole").val(),i=$("#editStatus").val();""!=a&&""!=t&&""!=s?r?$.ajax({type:"POST",url:"./backend/login/userOperation.php",data:{postType:"update",username:a,role:l,email:t,contact_num:s,login_attempt:o,password:e,status:i},beforeLoad:function(){$("#report-table").append('<div class="d-flex justify-content-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div>')},success:function(e){"Success"==e?($("#userTable").dataTable({bDestroy:!0}),n(),$("#editModal").modal("hide"),$("#editPassword").val(""),$("#editPasswordConfirm").val(""),$("#editEmail").val(""),$("#editContact").val(""),$("#editPasswordConfirm").removeClass("is-valid"),$("#editPasswordConfirmValidate").removeClass("valid-feedback").empty(),$("#successModalHeadline").empty().append("Updated"+a),$("#successModalBody").empty().append(a+"'s data has been updated"),$("#successToModal").modal("show")):console.log("no change")},error:function(){$("#editPassword").val(""),$("#editPasswordConfirm").val(""),$("#failedModalHeadline").empty().append("Failed to update"+a),$("#failedModalBody").empty().append("Update "+a+"'s data failed"),$("#failedToModal").modal("show")}}):(""==e&&""==d||""==e||""==d?($("#failedModalHeadline").empty().append("Failed to update"+a),$("#failedModalBody").empty().append("Either to fill in both password and confirm password for changing password, or let both password and confirm password blank for not changing password")):($("#failedModalHeadline").empty().append("Failed to update"+a),$("#failedModalBody").empty().append("Password is not matched with Confirm Password.")),$("#failedToModal").modal("show")):($("#failedModalHeadline").empty().append("Failed to Add User"),$("#failedModalBody").empty().append("Please fill up all the required fields"),$("#failedToModal").modal("show"))}),$("#deleteUserSubmitButton").click(function(){var a=$("#deleteUserName").text();$.ajax({type:"POST",url:"./backend/login/userOperation.php",data:{postType:"delete",username:a},beforeLoad:function(){$("#report-table").append('<div class="d-flex justify-content-center"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div>')},success:function(e){switch(e){case"Success":$("#userTable").dataTable({bDestroy:!0}),n(),$("#deleteModal").modal("hide"),$("#successModalHeadline").empty().append(a+" Deleted"),$("#successModalBody").empty().append(a+" has been deleted"),$("#successToModal").modal("show")}},error:function(){$("#deleteModal").modal("hide"),$("#failedModalHeadline").empty().append(a+" Deleted failed"),$("#failedModalBody").empty().append("Failed to delete "+a),$("#failedToModal").modal("show")}})})});