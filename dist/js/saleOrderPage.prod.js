"use strict";function salesOrderMainFunction(){var e,t,a,s,r=F(),n=P(r),o=!1,l=!1,d=!1,c=!1;function i(e,t){$(e).attr("disabled",!0),$(t).empty().html('\n        <div class="d-flex justify-content-center">\n            <div class="spinner-border" role="status">\n                <span class="sr-only">Loading...</span>\n            </div>\n        </div>\n        ')}function u(e,t,a){$(e).attr("disabled",!1),$(t).empty().text(a)}function p(t){var e,a;""!=$("#salesorder-search-customer_name").val()?(clearTimeout(e),e=setTimeout(function(){$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowCustomer",searchCustomerName:$("#salesorder-search-customer_name").val(),searchCustomerID:$("#salesorder-search-customer_id").val(),pageNum:t},success:function(e){"No result"==e?1==o&&($("#salesorder-customer-search").empty().html('\n                                <div class="row">\n                                    <div class="col-6">\n                                        <h5>'.concat(e,'</h5>\n                                    </div>\n                                    <div class="col-6 text-right">\n                                        <a class="btn btn-primary" href="./customerMaintenance.php">Go add new customer</a>\n                                    </div>\n                                </div>\n                                    \n                                ')),o=!1):""==e?($("#salesorder-customer-search").empty().removeClass("border"),o=!1):(a='\n                            <div class="sticky-top bg-white">\n                                <div class="row px-3 py-2">\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <p class="my-auto">Search Result: <span class="font-weight-bold" id="customerSearchRowTotal"></span></p>\n                                    </div>\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <div class="d-flex flex-row justify-content-end">\n                                            <p class="my-auto">Page : </p>\n                                            <input type="number" id="customerSearchCurrentPageNum" class="form-control w-25 mx-2 my-auto px-2 pageInput" min="1" value="'.concat(t,'">\n                                            <p class="my-auto"> of <span id="customerSearchPageTotal"></span></p>\n                                        </div>\n                                    </div>\n                                </div>\n                                <hr class="p-0 m-0">\n                            </div>\n                            <div class="overflow-auto" style="max-height:200px;">\n                            '),$.each(JSON.parse(e),function(e,t){a+='\n                                <a class="customer-search-results">\n                                    <div class="view overlay">\n                                        <div class="row px-3 py-2">\n                                            <div class="col-6">\n                                                <h5 class="my-auto customerName">'.concat(t.name,'</h5>\n                                            </div>\n                                            <div class="col-6 text-right">\n                                                <p class="my-auto customerID">').concat(t.customer_account,'</p>\n                                            </div>\n                                            <div class="mask flex-center rgba-grey-slight"> </div>\n                                        </div>\n                                    </div>\n                                </a>\n                                <hr class="p-0 m-0">\n                                ')}),a+="</div>",$("#salesorder-customer-search").empty().html(a),o=!1,$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowCountCustomer",searchCustomerName:$("#salesorder-search-customer_name").val(),searchCustomerID:""},success:function(e){var t,a;$("#customerSearchRowTotal").empty().html(e),t=e,a=Math.ceil(t/10),$("#customerSearchPageTotal").empty().text(a),$("#customerSearchCurrentPageNum").attr("max",a),$("#customerSearchCurrentPageNum").on("input",function(){""==$("#customerSearchCurrentPageNum").val()?console.log("empty customer search"):$("#customerSearchCurrentPageNum").val()<a?p($("#customerSearchCurrentPageNum").val()):p(a)})}}),$(".customer-search-results").click(function(){$("#salesorder-search-customer_name").val($(this).find(".customerName").text()),$("#salesorder-search-customer_id").val($(this).find(".customerID").text()),$("#salesorder-customer-search").empty().removeClass("border")}),$("#customerSearchCurrentPageNum").focusout(function(){p(parseInt($(this).val()))}))},error:function(e){O("Failed","Unexpected error occur : "+e)}})},1e3)):($("#salesorder-customer-search").empty().removeClass("border"),o=!1)}function m(t){var e,s;""!=$("#salesorder-search-item").val()?(clearTimeout(e),e=setTimeout(function(){$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowItem",search:$("#salesorder-search-item").val(),pageNum:t},success:function(e){"No result"==e?1==l&&($("#salesorder-item-search").empty().html('\n                                <div class="row">\n                                    <div class="col-6">\n                                        <h5>'.concat(e,'</h5>\n                                    </div>\n                                    <div class="col-6 text-right">\n                                        <a class="btn btn-primary" href="./itemMaintenance.php">Go add new item</a>\n                                    </div>\n                                </div>\n                                ')),l=!1):""==e?($("#salesorder-item-search").empty().removeClass("border"),l=!1):(s='\n                            <div class="sticky-top bg-white">\n                                <div class="row px-3 py-2 ">\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <p class="my-auto">Search Result: <span class="font-weight-bold" id="itemSearchRowTotal"></span></p>\n                                    </div>\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <div class="d-flex flex-row justify-content-end">\n                                            <p class="my-auto">Page : </p>\n                                            <input type="number" id="itemSearchCurrentPageNum" class="form-control w-25 mx-2 my-auto px-2 pageInput" min="1" value="'.concat(t,'">\n                                            <p class="my-auto"> of <span id="itemSearchPageTotal"></span></p>\n                                        </div>\n                                    </div>\n                                </div>\n                                <hr class="p-0 m-0">\n                            </div>\n                            <div class="overflow-auto" style="max-height:200px;">\n                            '),$.each(JSON.parse(e),function(e,t){var a=!1,a=0==t.qty_available;s+='\n                                <a class="item-search-results" data-id="'.concat(t.item_id,'" data-issoldout="').concat(a,'">\n                                    <div class="view overlay  ').concat(a?"red lighten-4":"",'">\n                                        <div class="row px-3 py-2">\n                                            <div class="col-8 d-flex flex-row">\n                                                <h5 class="my-auto">').concat(t.description,'</h5>\n                                                <small class="my-auto px-2 text-muted">').concat(t.item_no,'</small>\n                                            </div>\n                                            <div class="col-4 d-flex flex-row justify-content-end">\n                                                <strong class="my-auto">Qty: </strong>\n                                                <p class="my-auto px-1 ').concat(a?"text-danger":"",'">').concat(t.qty_available,'</p>\n                                            </div>\n                                            <div class="mask flex-center ').concat(a?"rgba-red-strong":"rgba-grey-slight",'"></div>\n                                        </div>\n                                    </div>\n                                </a>\n                                <hr class="p-0 m-0">\n                                ')}),s+="</div>",$("#salesorder-item-search").empty().html(s),l=!1,$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowCountItem",search:$("#salesorder-search-item").val()},success:function(e){var t,a;$("#itemSearchRowTotal").empty().html(e),t=e,a=Math.ceil(t/10),$("#itemSearchPageTotal").empty().text(a),$("#itemSearchCurrentPageNum").attr("max",a),$("#itemSearchCurrentPageNum").on("input",function(){""==$("#itemSearchCurrentPageNum").val()?console.log("empty item search"):$("#itemSearchCurrentPageNum").val()<a?m($("#itemSearchCurrentPageNum").val()):m(a)})},error:function(e){O("Failed","Unexpected error occur : "+e)}}),$(".item-search-results").click(function(){$(this).data("issoldout");$("#salesorder-item-search").empty().removeClass("border"),$("#salesorder-search-item").val(""),$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowItemAdd",itemID:$(this).data("id")},success:function(e){var s,r,n=[];$.each($(".update-item-row"),function(e,t){n.push($(".update-item-row:eq(".concat(e,")")).data("id"))}),$.each(JSON.parse(e),function(e,t){if(r=t.item_id,-1<$.inArray(t.item_id,n)){var a=$("[data-id="+t.item_id+"]").find(".itemQuantity").val();return $("[data-id="+t.item_id+"]").find(".itemQuantity").val(parseInt(a)+1),!1}s+='\n                                <tr class="item-row" data-id="'.concat(t.item_id,'">\n                                    <td>\n                                        <button class="btn btn-danger deleteItemBtn py-md-3 px-md-4 p-sm-3">\n                                            <i class="fas fa-trash-alt"></i>\n                                        </button>\n                                    </td>\n                                    <td class="item_no">').concat(t.item_no,'</td>\n                                    <td class="description">').concat(t.description,'</td>\n                                    <td>\n                                        <input type="number" class="form-control itemQuantity" min="1" value="1">\n                                    </td>\n                                    <td>\n                                        <input type="text" class="form-control itemUnit" value="unit">\n                                    </td>\n                                    <td class="selling_price">').concat(t.selling_price1,'</td>\n                                    <td>\n                                        <input type="number" class="form-control itemDiscount" value="0" min="0" max="100" step="1">\n                                    </td>\n                                    <td class="total_price"></td>\n                                </tr>\n                                ')}),0<$("#salesorder-item-bucket").find(".salesorder-noResultText").length&&$("#salesorder-item-bucket").empty(),""!=s&&$("#salesorder-item-bucket").append(s),h(r),v(),y(),$("#salespayment-amount_apply").change(function(){var e=parseFloat($(this).val()).toFixed(2);$(this).val(e),$("#salespayment_amountPaid").empty().text(e);var t=parseFloat($("#salespayment_amountPaid").text()),a=parseFloat($("#salespayment_totalCharge").text());a<t?$("#salespayment_exchange").empty().text((t-a).toFixed(2)):$("#salespayment_exchange").empty().text("0.00")}),$(".itemQuantity").change(function(){$(this).val()>parseInt($(this).attr("max"))&&$(this).val($(this).attr("max")),$(this).val()<parseInt($(this).attr("min"))&&$(this).val($(this).attr("min")),h($(this).closest("tr").data("id")),v(),y()}),$(".itemDiscount").change(function(){$(this).val()>parseInt($(this).attr("max"))&&$(this).val($(this).attr("max")),$(this).val()<parseInt($(this).attr("min"))&&$(this).val($(this).attr("min")),h($(this).closest("tr").data("id")),v(),y()}),$(".deleteItemBtn").click(function(){$(this).closest("tr").remove(),0==$.trim($("#salesorder-item-bucket").html()).length&&$("#salesorder-item-bucket").html('\n                    <tr class="salesorder-noResultText">\n                        <td colspan="9" class="text-center">\n                            <h5>No item added yet</h5>\n                        </td>\n                    </tr>\n                ')}),$("#salespayment_totalCharge").empty().text($("#salesorder-total_cost").text())},error:function(e){O("Failed","Unexpected error occur : "+e)}})}),$("#itemSearchCurrentPageNum").focusout(function(){m(parseInt($(this).val()))}))},error:function(e){O("Failed","Unexpected error occur : "+e)}})},1e3)):($("#salesorder-item-search").empty().removeClass("border"),l=!1)}function h(e){var t=$("[data-id='"+e+"']").find(".itemQuantity").val(),a=$("[data-id='"+e+"']").find(".itemDiscount").val(),s=$("[data-id='"+e+"']").find(".selling_price").text();0<a&&(s-=s*(a/100)),$("[data-id='"+e+"']").find(".total_price").text((t*s).toFixed(2))}function y(){var s=0;$.each($(".item-row"),function(e,t){var a=$(".item-row:nth-child("+(e+1)+")").find(".total_price").text();s+=parseFloat(a)}),$("#salesorder-total_cost, #salespayment_totalCharge").empty().html(s.toFixed(2)),parseFloat($("#salespayment_amountPaid").text())>parseFloat($("#salespayment_totalCharge").text())&&$("#salespayment_exchange").empty().text((parseFloat($("#salespayment_amountPaid").text())-parseFloat($("#salespayment_totalCharge").text())).toFixed(2))}function v(){var n=0;$.each($(".item-row"),function(e,t){var a=$(".item-row:nth-child("+(e+1)+")").find(".selling_price").text(),s=$(".item-row:nth-child("+(e+1)+")").find(".itemQuantity").val(),r=$(".item-row:nth-child("+(e+1)+")").find(".itemDiscount").val();0<r&&(n+=a*(r/100)*s)}),$("#salesorder-total_discount").empty().html(n.toFixed(2))}function f(t){var e,a;""!=$("#salesorder-update-search-customer_name").val()?(clearTimeout(e),e=setTimeout(function(){$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowCustomer",searchCustomerName:$("#salesorder-update-search-customer_name").val(),searchCustomerID:$("#salesorder-update-search-customer_id").val(),pageNum:t},success:function(e){"No result"==e?1==d&&($("#salesorder-update-customer-search").empty().html('\n                                <div class="row">\n                                    <div class="col-6">\n                                        <h5>'.concat(e,'</h5>\n                                    </div>\n                                    <div class="col-6 text-right">\n                                        <a class="btn btn-primary" href="./customerMaintenance.php">Go add new customer</a>\n                                    </div>\n                                </div>\n                                ')),d=!1):""==e?($("#salesorder-update-customer-search").empty().removeClass("border"),d=!1):(a='\n                            <div class="sticky-top bg-white">\n                                <div class="row px-3 py-2">\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <p class="my-auto">Search Result: <span class="font-weight-bold" id="updatecustomerSearchRowTotal"></span></p>\n                                    </div>\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <div class="d-flex flex-row justify-content-end">\n                                            <p class="my-auto">Page : </p>\n                                            <input type="number" id="updatecustomerSearchCurrentPageNum" class="form-control w-25 mx-2 my-auto px-2 pageInput" min="1" value="'.concat(t,'">\n                                            <p class="my-auto"> of <span id="updatecustomerSearchPageTotal"></span></p>\n                                        </div>\n                                    </div>\n                                </div>\n                                <hr class="p-0 m-0">\n                            </div>\n                            <div class="overflow-auto" style="max-height:200px;">\n                            '),$.each(JSON.parse(e),function(e,t){a+='\n                                <a class="update-customer-search-results">\n                                    <div class="view overlay">\n                                        <div class="row px-3 py-2">\n                                            <div class="col-6">\n                                                <h5 class="my-auto customerName">'.concat(t.name,'</h5>\n                                            </div>\n                                            <div class="col-6 text-right">\n                                                <p class="my-auto customerID">').concat(t.customer_account,'</p>\n                                            </div>\n                                            <div class="mask flex-center rgba-grey-slight"> </div>\n                                        </div>\n                                    </div>\n                                </a>\n                                <hr class="p-0 m-0">\n                                ')}),a+="</div>",$("#salesorder-update-customer-search").empty().html(a),d=!1,$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowCountCustomer",searchCustomerName:$("#salesorder-update-search-customer_name").val(),searchCustomerID:""},success:function(e){var t,a;$("#updateCustomerSearchRowTotal").empty().html(e),t=e,a=Math.ceil(t/10),$("#updatecustomerSearchPageTotal").empty().text(a),$("#updatecustomerSearchCurrentPageNum").attr("max",a),$("#updatecustomerSearchCurrentPageNum").on("input",function(){""==$("#updatecustomerSearchCurrentPageNum").val()?console.log("Empty update customer search"):$("#updatecustomerSearchCurrentPageNum").val()<a?f($("#updatecustomerSearchCurrentPageNum").val()):f(a)})}}),$(".update-customer-search-results").click(function(){$("#salesorder-update-search-customer_name").val($(this).find(".customerName").text()),$("#salesorder-update-search-customer_id").val($(this).find(".customerID").text()),$("#salesorder-update-customer-search").empty().removeClass("border")}))},error:function(e){O("Failed","Unexpected error occur : "+e)}})},1e3)):($("#salesorder-update-customer-search").empty().removeClass("border"),d=!1)}function _(t){var e,a;""!=$("#salesorder-update-search-item").val()?(clearTimeout(e),e=setTimeout(function(){$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowItem",search:$("#salesorder-update-search-item").val(),pageNum:t},success:function(e){"No result"==e?1==c&&($("#salesorder-update-item-search").empty().html('\n                                <div class="row">\n                                    <div class="col-6">\n                                        <h5>'.concat(e,'</h5>\n                                    </div>\n                                    <div class="col-6 text-right">\n                                        <a class="btn btn-primary" href="./itemMaintenance.php">Go add new item</a>\n                                    </div>\n                                </div>\n                                ')),c=!1):""==e?($("#salesorder-update-item-search").empty().removeClass("border"),c=!1):(a='\n                            <div class="sticky-top bg-white">\n                                <div class="row px-3 py-2 ">\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <p class="my-auto">Search Result: <span class="font-weight-bold" id="updateitemSearchRowTotal"></span></p>\n                                    </div>\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <div class="d-flex flex-row justify-content-end">\n                                            <p class="my-auto">Page : </p>\n                                            <input type="number" id="updateitemSearchCurrentPageNum" class="form-control w-25 mx-2 my-auto px-2 pageInput" min="1" value="'.concat(t,'">\n                                            <p class="my-auto"> of <span id="updateitemSearchPageTotal"></span></p>\n                                        </div>\n                                    </div>\n                                </div>\n                                <hr class="p-0 m-0">\n                            </div>\n                            <div class="overflow-auto" style="max-height:200px;">\n                            '),$.each(JSON.parse(e),function(e,t){isItemSoldOut=0==t.qty_available,a+='\n                                <a class="update-item-search-results" data-id="'.concat(t.item_id,'" data-issoldout="').concat(isItemSoldOut,'">\n                                    <div class="view overlay  ').concat(0==t.qty_available?"red lighten-4":"",'">\n                                        <div class="row px-3 py-2">\n                                            <div class="col-8 d-flex flex-row">\n                                                <h5 class="my-auto">').concat(t.description,'</h5>\n                                                <small class="my-auto px-2 text-muted">').concat(t.item_no,'</small>\n                                            </div>\n                                            <div class="col-4 d-flex flex-row justify-content-end">\n                                                <strong class="my-auto">Qty: </strong>\n                                                <p class="my-auto px-1 ').concat(0==t.qty_available?"text-danger":"",'">').concat(t.qty_available,'</p>\n                                            </div>\n                                            <div class="mask flex-center ').concat(0==t.qty_available?"rgba-red-strong":"rgba-grey-slight",'"></div>\n                                        </div>\n                                    </div>\n                                </a>\n                                <hr class="p-0 m-0">\n                                ')}),a+="</div>",$("#salesorder-update-item-search").empty().html(a),c=!1,$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowCountItem",search:$("#salesorder-update-search-item").val()},success:function(e){var t,a;$("#updateitemSearchRowTotal").empty().html(e),t=e,a=Math.ceil(t/10),$("#updateitemSearchPageTotal").empty().text(a),$("#updateitemSearchCurrentPageNum").attr("max",a),$("#updateitemSearchCurrentPageNum").on("input",function(){""==$("#updateitemSearchCurrentPageNum").val()?console.log("empty update item search"):$("#updateitemSearchCurrentPageNum").val()<a?_($("#updateitemSearchCurrentPageNum").val()):_(a)})}}),$(".update-item-search-results").click(function(){$("#salesorder-update-item-search").empty().removeClass("border"),$("#salesorder-update-search-item").val(""),$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowItemAdd",itemID:$(this).data("id")},success:function(e){var s,r,n=[];$.each($(".update-item-row"),function(e,t){n.push($(".update-item-row:eq(".concat(e,")")).data("id"))}),$.each(JSON.parse(e),function(e,t){var a;r=t.item_id,-1<$.inArray(t.item_id,n)?(a=$("[data-id="+t.item_id+"]").find(".update-itemQuantity").val(),$("[data-id="+t.item_id+"]").find(".update-itemQuantity").val(parseInt(a)+1)):s+='\n                                    <tr class="update-item-row" data-id="'.concat(t.item_id,'">\n                                        <td>\n                                            <button class="btn btn-danger update-deleteItemBtn py-md-3 px-md-4 p-sm-3">\n                                                <i class="fas fa-trash-alt"></i>\n                                            </button>\n                                        </td>\n                                        <td class="update-item_no">').concat(t.item_no,'</td>\n                                        <td class="update-description">').concat(t.description,'</td>\n                                        <td>\n                                            <input type="number" class="form-control update-itemQuantity" min="1 value="1">\n                                        </td>\n                                        <td>\n                                            <input type="text" class="form-control update-itemUnit" value="unit">\n                                        </td>\n                                        <td class="update-selling_price">').concat(t.selling_price1,'</td>\n                                        <td>\n                                            <input type="number" class="form-control update-itemDiscount" value="0" min="0" max="100" step="1">\n                                        </td>\n                                        <td class="update-total_price"></td>\n                                    </tr>\n                                    ')}),0<$("#salesorder-update-item-bucket").find(".salesorder-update-noResultText").length&&$("#salesorder-update-item-bucket").empty(),""!=s&&$("#salesorder-update-item-bucket").append(s),x(r),b(),g(),$("#salesorder-update-amount_apply").change(function(){var e=parseFloat($(this).val()).toFixed(2);$(this).val(e),console.log("in updateitem select",parseFloat($(this).val()).toFixed(2)),$("#update-salesorder_amountPaid").empty().text();var t=parseFloat($("#update-salesorder_amountPaid").text()),a=parseFloat($("#update-salesorder_totalCharge").text());a<t?$("#update-salesorder_exchange").empty().text((t-a).toFixed(2)):$("#update-salesorder_exchange").empty().text("0.00")}),$(".update-itemQuantity").change(function(){$(this).val()>parseInt($(this).attr("max"))&&$(this).val($(this).attr("max")),$(this).val()<parseInt($(this).attr("min"))&&$(this).val($(this).attr("min")),x($(this).closest("tr").data("id")),b(),g()}),$(".update-itemDiscount").change(function(){$(this).val()>parseInt($(this).attr("max"))&&$(this).val($(this).attr("max")),$(this).val()<parseInt($(this).attr("min"))&&$(this).val($(this).attr("min")),x($(this).closest("tr").data("id")),b(),g()}),$(".update-deleteItemBtn").click(function(){$(this).closest("tr").remove(),0==$.trim($("#salesorder-update-item-bucket").html()).length?($("#salesorder-update-item-bucket").html('\n                    <tr class="salesorder-update-noResultText">\n                        <td colspan="9" class="text-center">\n                            <h5>No item added yet</h5>\n                        </td>\n                    </tr>\n                '),b(),g(),$("#update-salespayment_totalCharge").empty().text("0.00")):(b(),g(),$("#update-salespayment_totalCharge").empty().text($("#salesorder-update-total_cost").text()))})}})}))},error:function(e){O("Failed","Unexpected error occur : "+e)}})},1e3)):($("#salesorder-update-item-search").empty().removeClass("border"),c=!1)}function x(e){var t=$("[data-id='"+e+"']").find(".update-itemQuantity").val(),a=$("[data-id='"+e+"']").find(".update-itemDiscount").val(),s=$("[data-id='"+e+"']").find(".update-selling_price").text();0<a&&(s-=s*(a/100)),$("[data-id='"+e+"']").find(".update-total_price").text((t*s).toFixed(2))}function g(){var s=0;$.each($(".update-item-row"),function(e,t){var a=$(".update-item-row:nth-child("+(e+1)+")").find(".update-total_price").text();s+=parseFloat(a)}),$("#salesorder-update-total_cost").empty().html(s.toFixed(2)),$("#update-salesorder_totalCharge").empty().text(s.toFixed(2)),parseFloat($("#update-salespayment_amountPaid").text())>parseFloat($("#update-salespayment_totalCharge").text())&&$("#update-salespayment_exchange").empty().text((parseFloat($("#update-salespayment_amountPaid").text())-parseFloat($("#update-salespayment_totalCharge").text())).toFixed(2))}function b(){var n=0;$.each($(".update-item-row"),function(e,t){var a=$(".update-item-row:nth-child("+(e+1)+")").find(".update-selling_price").text(),s=$(".update-item-row:nth-child("+(e+1)+")").find(".update-itemQuantity").val(),r=$(".update-item-row:nth-child("+(e+1)+")").find(".update-itemDiscount").val();0<r&&(n+=a*(r/100)*s)}),$("#salesorder-update-total_discount").empty().html(n.toFixed(2))}function S(e){var t="",a="",s="",r="",n="",o="",l="",d="",c=[],i=[],u=[],p=[],m=[],h=[],y=[],v=[];if(0<$("#salesorder-item-bucket").find(".salesorder-noResultText").length)O("Failed","Item bucket is empty"),$(".btnDismiss").click(function(){$("#salesorder-search-item").focus()});else switch(t=$("#salesorder-salesperson").val(),a=(parseFloat($("#salesorder-total_cost").text())+parseFloat($("#salesorder-total_discount").text())).toFixed(2),s=$("#salesorder-total_discount").text(),r=$("#salesorder-total_cost").text(),n=$("#salespayment-payment_mode").val(),l=$("#salespayment_amountPaid").text(),o=$("#salespayment_totalCharge").text(),d=$("#salespayment-reference").val(),$.each($(".item-row"),function(e,t){c.push($(".item-row:nth-child("+(e+1)+")").data("id")),i.push($(".item-row:nth-child("+(e+1)+")").find(".item_no").text()),u.push($(".item-row:nth-child("+(e+1)+")").find(".description").text()),v.push($(".item-row:nth-child("+(e+1)+")").find(".selling_price").text()),m.push($(".item-row:nth-child("+(e+1)+")").find(".itemQuantity").val()),h.push($(".item-row:nth-child("+(e+1)+")").find(".total_price").text()),p.push($(".item-row:nth-child("+(e+1)+")").find(".itemUnit").val()),y.push($(".item-row:nth-child("+(e+1)+")").find(".itemDiscount").val())}),e){case"add":parseFloat($("#salespayment_amountPaid").text())<parseFloat($("#salespayment_totalCharge").text())?O("Failed","Amount Paid is less than Total Charge"):$.ajax({type:"POST",url:"./backend/sale/saleOrder.php",data:{postType:"add",sale_salesperson:t,sale_subtotal:a,sale_discount_header:s,sale_total_amount:r,item_id:c,item_no:i,description:u,uom:p,qty:m,price:h,discount:y,amount:v,payment_method:n,sale_amount:o,sale_payment:l,reference:d},success:function(e){switch(e){case"Some input field is not set.":O("Failed",e);break;case"success add":$("#addSalesOrderModal").modal("hide"),C("Success","Sale Order is successfully paid"),$(".btnSuccess").click(function(){location.reload()})}},error:function(e){O("Failed","Unexpected error occur : "+e)}});break;case"onhold":$.ajax({type:"POST",url:"./backend/sale/saleOnHold.php",data:{postType:"add",sale_salesperson:t,sale_subtotal:a,sale_discount_header:s,sale_total_amount:r,item_id:c,item_no:i,description:u,uom:p,qty:m,price:h,discount:y,amount:v},success:function(e){switch(e){case"Some input field is not set.":O("Failed",e);break;case"success add":$("#addSalesOrderModal").modal("hide"),C("Success","Sale Order is successfully added and it is on hold"),$(".btnSuccess").click(function(){location.reload()})}},error:function(e){O("Failed","Unexpected error occur : "+e)}})}}function w(e){var t="",a="",s="",r="",n="",o="",l="",d="",c="",i="",u=[],p=[],m=[],h=[],y=[],v=[],f=[],_=[];switch(e){case"onhold":0<$("#salesorder-update-item-bucket").find(".salesorder-update-noResultText").length?(O("Failed","Item bucket is empty"),$(".btnDismiss").click(function(){$("#salesorder-search-item").focus()})):(t=$("#salesorder-update-salesperson").val(),a=(parseFloat($("#salesorder-update-total_discount").text())+parseFloat($("#salesorder-update-total_cost").text())).toFixed(2),s=$("#salesorder-update-total_discount").text(),r=$("#salesorder-update-total_cost").text(),n=$("#salesorder-update-search-customer_name").val(),o=$("#salesorder-update-search-customer_id").val(),l=$("#salesorder-update-payment_mode").val(),c=$("#update-salespayment_amountPaid").text(),d=$("#update-salespayment_totalCharge").text(),i=$("#salesorder-update-reference").val(),$.each($(".update-item-row"),function(e,t){u.push($(".update-item-row:nth-child("+(e+1)+")").data("id")),p.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-item_no").text()),m.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-description").text()),_.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-selling_price").text()),y.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-itemQuantity").val()),v.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-total_price").text()),h.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-itemUnit").val()),f.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-itemDiscount").val())}),$.ajax({type:"POST",url:"./backend/sale/saleOnHold.php",data:{postType:"update",sale_id:$("#update-salesorder_id").val(),customer_account:o,customer_name:n,sale_salesperson:t,sale_subtotal:a,sale_discount_header:s,sale_total_amount:r,item_id:u,item_no:p,description:m,uom:h,qty:y,price:v,discount:f,amount:_},success:function(e){switch(console.log(e),e){case"Some input field is not set.":$("#addSalesOrderModal").modal("hide"),O("Failed",e);break;case"success edit":$("#editSalesOrderModal").modal("hide"),C("Success","Sale Order is successfully updated"),$(".btnSuccess").click(function(){location.reload()});break;case"item detail not found":O("Failed",e)}},error:function(e){O("Failed","Unexpected error occur : "+e)}}));break;case"update":0<$("#salesorder-update-item-bucket").find(".salesorder-update-noResultText").length?O("Failed","Item bucket is empty"):(t=$("#salesorder-update-salesperson").val(),a=(parseFloat($("#salesorder-update-total_discount").text())+parseFloat($("#salesorder-update-total_cost").text())).toFixed(2),s=$("#salesorder-update-total_discount").text(),r=$("#salesorder-update-total_cost").text(),n=$("#salesorder-update-search-customer_name").val(),o=$("#salesorder-update-search-customer_id").val(),l=$("#salesorder-update-payment_mode").val(),c=$("#update-salespayment_amountPaid").text(),d=$("#update-salespayment_totalCharge").text(),i=$("#salesorder-update-reference").val(),$.each($(".update-item-row"),function(e,t){u.push($(".update-item-row:nth-child("+(e+1)+")").data("id")),p.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-item_no").text()),m.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-description").text()),_.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-selling_price").text()),y.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-itemQuantity").val()),v.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-total_price").text()),h.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-itemUnit").val()),f.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-itemDiscount").val())}),$.ajax({type:"POST",url:"./backend/sale/saleOrder.php",data:{postType:"update",sale_id:$("#update-salesorder_id").val(),customer_account:o,customer_name:n,sale_salesperson:t,sale_subtotal:a,sale_discount_header:s,sale_total_amount:r,item_id:u,item_no:p,description:m,uom:h,qty:y,price:v,discount:f,amount:_,payment_method:l,sale_amount:d,sale_payment:c,reference:i},success:function(e){switch(e){case"Some input field is not set.":$("#addSalesOrderModal").modal("hide"),O("Failed",e);break;case"success edit":$("#editSalesOrderModal").modal("hide"),C("Success","Sale Order is successfully updated"),$(".btnSuccess").click(function(){location.reload()});break;case"item detail not found":O("Failed",e)}},error:function(e){O("Failed","Unexpected error occur : "+e)}}))}}function O(e,t){$("#failedToModal").modal("show"),$("#failedModalHeadline").empty().append(e),$("#failedModalBody").empty().append(t)}function C(e,t){$("#successModalHeadline").empty().append(e),$("#successModalBody").empty().append(t),$("#successToModal").modal("show")}function F(){var t;return $.ajax({type:"POST",url:"./backend/sale/saleOrder.php",data:{postType:"countRow"},async:!1,success:function(e){$("#salesorder-rowTotal").empty().append(e),t=e},error:function(e){O("Failed","Unexpected error occur : "+e)}}),t}function P(e){var t=Math.ceil(e/20);return $("#salesorder-pageTotal").empty().text(t),$("#salesorder-currentPageNum").val()>t&&$("#salesorder-currentPageNum").val(t),t}function T(){var e;r=F(),n=P(r);var t="viewSaleHeader",a="./backend/sale/saleOrder.php";switch($("input[name='showingsalesordermode']:checked").val()){case"paid":t="viewSaleHeader",a="./backend/sale/saleOrder.php";break;case"onhold":t="viewSaleHeaderOnHold",a="./backend/sale/saleOnHold.php"}e=0!=$("#salesorder-currentPageNum").val()?$("#salesorder-currentPageNum").val()>n?n:$("#salesorder-currentPageNum").val():1,$("#salesorder-currentPageNum").val(e),$.ajax({type:"POST",url:a,data:{postType:t,pageNum:e},success:function(e){"0 results"==e||"No Result"==e?(N("salesorder"),k("salesorder")):(function(e,t){switch(t){case"salesorder":N("salesorder"),$.each(e,function(e,t){var a=t.creation_time.split(":"),s=12<parseInt(a[0])?parseInt(a[0])-12:parseInt(a[0]),r=a[1],n=12<parseInt(a[0])?"pm":"am",o=s.toString()+":"+r+" "+n;$("#salesorderContent").append('\n                        <tr class="salesorder-row" data-salesorder-id="'.concat(t.sale_id,'">\n                            <th>').concat(++e,"</th>\n                            <td>\n                                ").concat("UnPaid"==t.payment_status?'<button title="Update Sales Order" class="btn btn-warning editSalesOrderBtn py-md-3 px-md-4 p-sm-3" data-toggle="modal" data-target="#editSalesOrderModal"><i class="fas fa-edit"></i></button>':'<button title="View Sales Order Detail" class="btn btn-secondary viewSalesOrderDetailBtn py-md-3 px-md-4 p-sm-3"><i class="fas fa-file-invoice"></i> </button>',"\n                                ").concat("UnPaid"==t.payment_status?'<button title="Delete Sales Order" class="btn btn-danger deleteSalesOrderBtn py-md-3 px-md-4 p-sm-3" data-toggle="modal" data-target="#deleteSalesOrderModal"><i class="fas fa-trash-alt"></i></button>':"",'\n                            </td>\n                            <td class="sale_id">').concat(t.sale_id,'</td>\n                            <td class="customer_account">').concat(t.customer_account,'</td>\n                            <td class="customer_name">').concat(t.customer_name,'</td>\n                            <td class="sale_time">').concat(o,'</td>\n                            <td class="sale_date">').concat(t.sale_date,'</td>\n                            <td class="sale_phone_num">').concat(t.sale_phone_num,'</td>\n                            <td class="sale_salesperson">').concat(t.sale_salesperson,'</td>\n                            <td class="sale_subtotal">').concat(t.sale_subtotal,'</td>\n                            <td class="sale_discount_header">').concat(t.sale_discount_header,'</td>\n                            <td class="sale_total_amount">').concat(t.sale_total_amount,'</td>\n                            <td class="payment_status capitalize font-weight-bold ').concat("UnPaid"==t.payment_status?"text-danger":"text-success",'">').concat(t.payment_status,'</td>\n                            <td class="isOnHold">').concat(t.isOnHold?"Yes":"No","</td>\n                        </tr>\n                    "))}),k("salesorder")}}(JSON.parse(e),"salesorder"),$(".viewSalesOrderDetailBtn").click(function(){var e;e=$(this),$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"viewSalePaymentDetail",sale_id:$(e).parent().parent().data("salesorder-id")},success:function(e){var t=JSON.parse(e),a="",s=0,r=0;console.log(t),$.each(t[2],function(e,t){$("#salepaymentdetail-sale_payment_date").empty().text(t.sale_payment_date),$("#salepaymentdetail-sale_payment_time").empty().text(t.sale_payment_time),$("#salepaymentdetail-payment_method").empty().text(t.payment_method),$("#salepaymentdetail-reference").empty().text(t.reference),$("#update-salespayment_amountPaid-detail").empty().text(t.sale_payment),$("#update-salespayment_totalCharge-detail").empty().text(t.sale_amount),$("#update-salespayment_exchange-detail").empty().text(0<parseFloat(t.sale_payment)-parseFloat(t.sale_amount)?(parseFloat(t.sale_payment)-parseFloat(t.sale_amount)).toFixed(2):"0.00")}),$.each(t[0],function(e,t){$("#saleorderdetail-sale_id").empty().text(t.sale_id),$("#saleorderdetail-customer_account").empty().text(t.customer_account),$("#saleorderdetail-customer_name").empty().text(t.customer_name),$("#saleorderdetail-sale_salesperson").empty().text(t.sale_salesperson),$("#saleorderdetail-sale_subtotal").empty().text(t.sale_subtotal),$("#saleorderdetail-sale_discount_header").empty().text(parseFloat(t.sale_discount_header).toFixed(2)),$("#saleorderdetail-sale_total_amount").empty().text(t.sale_total_amount)}),$.each(t[1],function(e,t){"No Result"==t?O("Failed","Could not find any sale order"):(r+=parseFloat(t.amount)*(parseFloat(t.discount)/100),s+=parseFloat(t.price),a+="\n                            <tr>\n                                <td>".concat(t.item_no,"</td>\n                                <td>").concat(t.description,"</td>\n                                <td>").concat(t.qty,"</td>\n                                <td>").concat(t.uom,"</td>\n                                <td>").concat(t.amount,"</td>\n                                <td>").concat(parseInt(t.discount),"</td>\n                                <td>").concat(t.price,"</td>\n                            </tr>\n                            "))}),$("#salesorderdetail-item-bucket").empty().html(a),$("#saleorderdetail-total_discount").empty().text(r.toFixed(2)),$("#saleorderdetail-total_cost").empty().text(s.toFixed(2)),$("#salesOrderDetailModal").modal("show")},error:function(e){O("Failed","Unexpected error occur : "+e)}})}),$(".editSalesOrderBtn").click(function(){var e=$(this).parent().parent().data("salesorder-id"),t=$(this).parent().parent(),d=!1;switch(t.find(".payment_status").text()){case"Unpaid":d=!1;break;case"Paid":d=!0}switch($("#update-salesorder_totalCharge").empty().text(t.find(".sale_total_amount").text()),$("#update-salesorder_id").val(e),$("#salesorder-update-search-customer_name").val(t.find(".customer_name").text()),$("#salesorder-update-search-customer_id").val(t.find(".customer_account").text()),$("#salesorder-update-salesperson").val(t.find(".sale_salesperson").text()),$("#update-salesorder_payment_status").val(t.find(".payment_status").text()),$("#update-salesorder_isOnHold").val(t.find(".isOnHold").text()),$("#salesorder-update-reference").val(t.data("reference")),t.find(".isOnHold").text()){case"Yes":$("#editonholdSalesOrderSubmitBtn").attr("disabled",!1);break;case"No":$("#editonholdSalesOrderSubmitBtn").attr("disabled",!0)}d?($("#salesorder-update-search-customer_name").attr("readonly",!0),$("#salesorder-update-payment_mode").attr("readonly",!0),$("#salesorder-update-salesperson").attr("readonly",!0),$("#salesorder-update-search-item").attr("readonly",!0)):($("#salesorder-update-search-customer_name").attr("readonly",!1),$("#salesorder-update-payment_mode").attr("readonly",!1),$("#salesorder-update-salesperson").attr("readonly",!1),$("#salesorder-update-search-item").attr("readonly",!1)),$.ajax({type:"POST",url:"./backend/sale/saleOrder.php",data:{postType:"viewDetail",search:e},success:function(e){var n,o=0,l=0;"No Result"==e?O("Failed","No sales order detail found"):($.each(JSON.parse(e),function(e,t){var a=(0==t.discount?100:t.discount)/100,s=1==a?0:t.amount*a*t.qty,r=t.amount*t.qty-s;o+=r,l+=s,$.ajax({type:"POST",url:"./backend/invoice/viewCustmrItem.php",data:{postType:"searchRowItemGetQuantity",itemID:t.item_id},async:!1,success:function(e){parseInt(e)},error:function(e){console.log(e)}}),n+='\n                                        <tr class="update-item-row" data-id="'.concat(t.item_id,'">\n                                            <td>\n                                                <button class="btn ').concat(d?"btn-light":"btn-danger update-deleteItemBtn",' py-md-3 px-md-4 p-sm-3">\n                                                    <i class="fas fa-trash-alt"></i>\n                                                </button>\n                                            </td>\n                                            <td class="update-item_no">').concat(t.item_no,'</td>    \n                                            <td class="update-description">').concat(t.description,"</td>\n                                            <td>\n                                                <input ").concat(d?"readonly":"",' type="number" class="form-control update-itemQuantity" min="1" value="').concat(t.qty,'">\n                                            </td>\n                                            <td>\n                                                <input ').concat(d?"readonly":"",' type="text" class="form-control update-itemUnit" placeholder="unit" val="').concat(t.uom,'">\n                                            </td>\n                                            <td class="update-selling_price">').concat(t.amount,"</td>\n                                            <td>\n                                                <input ").concat(d?"readonly":"",' type="number" class="form-control update-itemDiscount" value="').concat(t.discount,'" min="0" max="100" step="1">\n                                            </td>\n                                            <td class="update-total_price">').concat(r.toFixed(2),"</td>\n                                        </tr>\n                                        ")}),$("#salesorder-update-item-bucket").empty().append(n),$("#salesorder-update-total_discount").empty().text(l.toFixed(2)),$("#salesorder-update-total_cost").empty().text(o.toFixed(2)),$(".update-deleteItemBtn").click(function(){$(this).closest("tr").remove(),0==$.trim($("#salesorder-update-item-bucket").html()).length?($("#salesorder-update-item-bucket").html('\n                                                <tr class="salesorder-update-noResultText">\n                                                    <td colspan="9" class="text-center">\n                                                        <h5>No item added yet</h5>\n                                                    </td>\n                                                </tr>\n                                            '),b(),g(),$("#update-salespayment_totalCharge").empty().text("0.00")):(b(),g(),$("#update-salespayment_totalCharge").empty().text($("#salesorder-update-total_cost").text()))}),$(".update-itemQuantity").change(function(){$(this).val()>parseInt($(this).attr("max"))&&$(this).val($(this).attr("max")),$(this).val()<parseInt($(this).attr("min"))&&$(this).val($(this).attr("min")),x($(this).closest("tr").data("id")),b(),g()}),$(".update-itemDiscount").change(function(){$(this).val()>parseInt($(this).attr("max"))&&$(this).val($(this).attr("max")),$(this).val()<parseInt($(this).attr("min"))&&$(this).val($(this).attr("min")),x($(this).closest("tr").data("id")),b(),g()}),$("#salesorder-update-amount_apply").focusout(function(){var e=parseFloat($(this).val()).toFixed(2);$(this).val(e),console.log("in on click edit button",$(this).val()),$("#update-salesorder_amountPaid").empty().html($(this).val());var t=parseFloat($("#update-salesorder_amountPaid").text()),a=parseFloat($("#update-salesorder_totalCharge").text());a<t?$("#update-salesorder_exchange").empty().text((t-a).toFixed(2)):$("#update-salesorder_exchange").empty().text("0.00")}))},error:function(e){O("Failed","Unexpected error occur : "+e)}})}),$(".deleteSalesOrderBtn").click(function(){var e=$(this).parent().parent().data("salesorder-id"),t=$(this).parent().parent();$("#salesorderDelete_isPaid").val(t.find(".payment_status").text()),$("#delete_id").val(e),$("#deleteSalesOrderName").text(e),$("#salesorderDelete_isOnHold").val(t.find(".isOnHold").text())}))},error:function(e){O("Failed","Unexpected error occur : "+e)}})}function k(e){switch(e){case"salesorder":$("#salesorderTable").DataTable({searching:!1,paginate:!1,lengthChange:!1,info:!1,scrollX:!0,scrollY:"1000px",scrollCollapse:!0}).columns.adjust();$(".dataTables_length").addClass("bs-select")}}function N(e){switch(e){case"salesorder":$("#salesorder-table").empty().append('<table id="salesorderTable" class="table table-hover table-bordered table_fullwidth text-center" cellspacing="0" >  <thead class="grey lighten-2  ">  <tr>  <th scope="col">#</th>  <th scope="col" class="text-center th-lg">Action</th>  <th scope="col" class="th-lg">Sale ID</th>  <th scope="col" class="th-lg">Customer Account</th>  <th scope="col" class="th-lg">Customer Name</th>  <th scope="col" class="th-lg">Sale Time</th>  <th scope="col" class="th-lg">Sale Date</th>  <th scope="col" class="th-lg">Sale Phone Number</th>  <th scope="col" class="th-lg">Saleperson</th>  <th scope="col" class="th-lg">Sale Subtotal</th>  <th scope="col" class="th-lg">Sale Total Discount</th>  <th scope="col" class="th-lg">Sale Total Amount</th>  <th scope="col" class="th-lg">Payment Status</th>  <th scope="col" class="th-lg">Is On Hold ?</th>  </tr>  </thead>  <tbody id="salesorderContent">  </tbody>  <tfoot class="grey lighten-2">  <tr>  <th scope="col">#</th>  <th scope="col" class="text-center th-lg">Action</th>  <th scope="col" class="th-lg">Sale ID</th>  <th scope="col" class="th-lg">Customer Account</th>  <th scope="col" class="th-lg">Customer Name</th>  <th scope="col" class="th-lg">Sale Time</th>  <th scope="col" class="th-lg">Sale Date</th>  <th scope="col" class="th-lg">Sale Phone Number</th>  <th scope="col" class="th-lg">Saleperson</th>  <th scope="col" class="th-lg">Sale Subtotal</th>  <th scope="col" class="th-lg">Sale Total Discount</th>  <th scope="col" class="th-lg">Sale Total Amount</th>  <th scope="col" class="th-lg">Payment Status</th>  <th scope="col" class="th-lg">Is On Hold ?</th>  </tr>  </tfoot>  </table>')}}T(),$("#salesorder-currentPageNum").focusout(function(){T()}),$("input[name='showingsalesordermode']").change(function(){T()}),$("#salesorder-search-customer_name").on("keyup",function(){clearTimeout(e),o||($("#salesorder-customer-search").empty().addClass("border").html('\n            <div class="d-flex justify-content-center">\n                <div class="spinner-border" role="status">\n                    <span class="sr-only">Loading...</span>\n                </div>\n            </div>\n            '),o=!0),$(this).val()?e=setTimeout(function(){p(1)},1e3):($("#salesorder-customer-search").empty().removeClass("border"),o=!1)}),$("#salesorder-search-item").on("keyup",function(){clearTimeout(t),l||($("#salesorder-item-search").empty().addClass("border").html('\n            <div class="d-flex justify-content-center">\n                <div class="spinner-border" role="status">\n                    <span class="sr-only">Loading...</span>\n                </div>\n            </div>\n            '),l=!0),$(this).val()?t=setTimeout(function(){m(1)},1e3):($("#salesorder-item-search").empty().removeClass("border"),o=!1)}),$("#salesorder-update-search-customer_name").on("keyup",function(){clearTimeout(a),d||($("#salesorder-update-customer-search").empty().addClass("border").html('\n            <div class="d-flex justify-content-center">\n                <div class="spinner-border" role="status">\n                    <span class="sr-only">Loading...</span>\n                </div>\n            </div>\n            '),d=!0),$(this).val()?a=setTimeout(function(){f(1)},1e3):($("#salesorder-update-customer-search").empty().removeClass("border"),isSpinnerOn=!1)}),$("#salesorder-update-search-item").on("keyup",function(){clearTimeout(s),c||($("#salesorder-update-item-search").empty().addClass("border").html('\n            <div class="d-flex justify-content-center">\n                <div class="spinner-border" role="status">\n                    <span class="sr-only">Loading...</span>\n                </div>\n            </div>\n            '),c=!0),$(this).val()?s=setTimeout(function(){_(1)},1e3):($("#salesorder-update-item-search").empty().removeClass("border"),c=!1)}),$("#addSalesOrderModalBtn").click(function(){$("#salesorder-salesperson, #salesorder-search-item, #salesorder-search-customer_id, #salesorder-search-customer_name, #salespayment-reference").val(""),$("#salesorder-payment_mode").val("cash"),$("#salespayment-amount_apply").val("0.00"),$("#salesorder-total_discount, #salesorder-total_cost").empty(),$("#salespayment_totalCharge, #salespayment_amountPaid, #salespayment_exchange").empty().text("0.00"),$("#salesorder-item-bucket").empty().html('\n        <tr class="salesorder-noResultText">\n            <td colspan="9" class="text-center">\n                <h5>No item added yet</h5>\n            </td>\n        </tr>\n        ')}),$("#addSalesOrderSubmitBtn").click(function(){i("#addSalesOrderSubmitBtn, #onholdSalesOrderSubmitBtn","#addSalesOrderSubmitBtn"),setTimeout(function(){parseFloat($("#salespayment_amountPaid").text())<=0?O("Failed","Current payment amount is 0"):parseFloat($("#salespayment_totalCharge").text())>parseFloat($("#salespayment_amountPaid").text())?O("Failed","Amount paid is not enough to fulfill current charge"):0<$("#salesorder-item-bucket").find(".salesorder-noResultText").length?O("Failed","No sales order added yet"):S("add"),u("#addSalesOrderSubmitBtn, #onholdSalesOrderSubmitBtn","#addSalesOrderSubmitBtn","Pay")},1e3)}),$("#onholdSalesOrderSubmitBtn").click(function(){i("#addSalesOrderSubmitBtn, #onholdSalesOrderSubmitBtn","#onholdSalesOrderSubmitBtn"),setTimeout(function(){S("onhold"),u("#addSalesOrderSubmitBtn, #onholdSalesOrderSubmitBtn","#onholdSalesOrderSubmitBtn","On Hold")},1e3)}),$("#editonholdSalesOrderSubmitBtn").click(function(){i("#editonholdSalesOrderSubmitBtn, #editSalesOrderSubmitBtn","#editonholdSalesOrderSubmitBtn"),setTimeout(function(){var e,t,a,s,r,n,o,l;parseFloat($("#update-salesorder_amountPaid").text())<=0?O("Failed","Current payment amount is 0"):parseFloat($("#update-salesorder_totalCharge").text())>parseFloat($("#update-salesorder_amountPaid").text())?O("Failed","Amount paid is not enough to fulfill current charge"):0<$("#salesorder-update-item-bucket").find(".salesorder-update-noResultText").length?O("Failed","No sales order added yet"):(e=$("#salesorder-update-search-customer_name").val(),t=$("#update-salesorder_id").val(),a=$("#salesorder-update-payment_mode").val(),s=$("#update-salesorder_totalCharge").text(),r=$("#update-salesorder_amountPaid").text(),n=$("#salesorder-update-reference").val(),o=[],l=[],$.each($(".update-item-row"),function(e,t){o.push($(".update-item-row:nth-child("+(e+1)+")").data("id")),l.push($(".update-item-row:nth-child("+(e+1)+")").find(".update-itemQuantity").val())}),$.ajax({type:"POST",url:"./backend/sale/saleOnHold.php",data:{postType:"payOnHold",item_id:o,qty:l,customer_name:e,sale_id:t,payment_method:a,sale_amount:s,sale_payment:r,reference:n},success:function(e){switch(e){case"Some input field is not set.":O("Failed",e);break;case"success add payment for on-hold sale order":$("#editSalesOrderModal").modal("hide"),C("Success","Sale Payment is successfully paid"),$(".btnSuccess").click(function(){location.reload()})}},error:function(e){O("Failed","Unexpected error occur : "+e)}})),u("#editonholdSalesOrderSubmitBtn, #editSalesOrderSubmitBtn","#editonholdSalesOrderSubmitBtn","Pay")},1e3)}),$("#editSalesOrderSubmitBtn").click(function(){$(this).attr("disabled",!0).empty().html('\n        <div class="d-flex justify-content-center">\n            <div class="spinner-border" role="status">\n                <span class="sr-only">Loading...</span>\n            </div>\n        </div>\n        '),i("#editonholdSalesOrderSubmitBtn, #editSalesOrderSubmitBtn","#editSalesOrderSubmitBtn"),setTimeout(function(){switch($("#update-salesorder_payment_status").val()){case"UnPaid":switch($("#update-salesorder_isOnHold").val()){case"Yes":w("onhold"),u("#editonholdSalesOrderSubmitBtn, #editSalesOrderSubmitBtn","#editSalesOrderSubmitBtn","Update");break;case"No":w("update"),u("#editonholdSalesOrderSubmitBtn, #editSalesOrderSubmitBtn","#editSalesOrderSubmitBtn","Update")}break;case"Paid":console.log("triggered"),u("#editonholdSalesOrderSubmitBtn, #editSalesOrderSubmitBtn","#editSalesOrderSubmitBtn","Update")}},1e3)}),$("#deleteSalesOrderSubmitButton").click(function(){switch($("#salesorderDelete_isPaid").val()){case"UnPaid":$.ajax({type:"POST",url:"./backend/sale/saleOnHold.php",data:{postType:"delete",sale_id:$("#delete_id").val()},success:function(e){switch(e){case"success delete":$("#deleteSalesOrderModal").modal("hide"),C("Success","Sale Order is successfully deleted"),$(".btnSuccess").click(function(){location.reload()});break;case"id not found":case"Some input field is not set.":$("#deleteSalesOrderModal").modal("hide"),O("Failed",e)}},error:function(e){O("Failed","Unexpected error occur : "+e)}});break;case"Paid":$("#deleteSalesOrderModal").modal("hide"),O("Failed","This sale order has been paid and cannot be deleted for the sake of record")}})}salesOrderMainFunction();