"use strict";$(document).ready(function(){console.log("sales payment page script");var e,o=t(),c=u(o),s=!1,a=!1;function n(a){var e,t;""!=$("#salespayment-search-salesorder").val()?(clearTimeout(e),e=setTimeout(function(){$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"salesorderSearch",searchSalesOrder:$("#salespayment-search-salesorder").val(),pageNum:a},success:function(e){"No result"==e?1==s&&($("#salespayment-salesorder-search").empty().html('\n                                <div class="row">\n                                    <div class="col-6">\n                                        <h5>'.concat(e,'</h5>\n                                    </div>\n                                    <div class="col-6 text-right">\n                                        <a class="btn btn-primary" href="./itemMaintenance.php">Go add new item</a>\n                                    </div>\n                                </div>\n                                ')),s=!1):""==e?($("#salespayment-salesorder-search").empty().removeClass("border"),s=!1):(t='\n                            <div class="sticky-top bg-white">\n                                <div class="row px-3 py-2 ">\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <p class="my-auto">Search Result: <span class="font-weight-bold" id="salespaymentSearchRowTotal"></span></p>\n                                    </div>\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <div class="d-flex flex-row justify-content-end">\n                                            <p class="my-auto">Page : </p>\n                                            <input type="number" id="salespaymentSearchCurrentPageNum" class="form-control w-25 mx-2 my-auto px-2 pageInput" min="1" value="'.concat(a,'">\n                                            <p class="my-auto"> of <span id="salespaymentSearchPageTotal"></span></p>\n                                        </div>\n                                    </div>\n                                </div>\n                                <hr class="p-0 m-0">\n                            </div>\n                            <div class="overflow-auto" style="max-height:200px;">\n                            '),$.each(JSON.parse(e),function(e,a){t+='\n                                <a class="salespayment-search-results" data-id="'.concat(a.sale_id,'">\n                                    <div class="view overlay  ').concat("Unpaid"==a.payment_status?"":"green lighten-4",'">\n                                        <div class="row px-3 py-2">\n                                            <div class="col-8 d-flex flex-row">\n                                                <h5 class="my-auto">').concat(a.sale_id,'</h5>\n                                                <small class="my-auto px-2 text-muted">').concat(a.customer_name,'</small>\n                                            </div>\n                                            <div class="col-4 d-flex flex-row justify-content-end">\n                                                <strong class="my-auto">Status</strong>\n                                                <p class="my-auto px-1 font-weight-bold ').concat("Unpaid"==a.payment_status?"text-danger":"text-success",'">').concat(a.payment_status,'</p>\n                                            </div>\n                                            <div class="mask flex-center ').concat("Unpaid"==a.payment_status?"rgba-grey-slight":"rgba-green-strong",'"></div>\n                                        </div>\n                                    </div>\n                                </a>\n                                <hr class="p-0 m-0">\n                                '),t+="</div>",$("#salespayment-salesorder-search").empty().html(t),s=!1,$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"salesorderCountRow",searchSalesOrder:$("#salespayment-search-salesorder").val()},success:function(e){var a,t;$("#salespaymentSearchPageTotal").empty().html(e),a=e,t=Math.ceil(a/10),$("#salespaymentSearchPageTotal").empty().text(t),$("#salespaymentSearchCurrentPageNum").attr("max",t),$("#salespaymentSearchCurrentPageNum").on("input",function(){""==$("#salespaymentSearchCurrentPageNum").val()?console.log("empty item search"):$("#salespaymentSearchCurrentPageNum").val()<t?n($("#salespaymentSearchCurrentPageNum").val()):n(t)})},error:function(e){p("Failed","Unexpected error occur : "+e)}}),$(".salespayment-search-results").click(function(){$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"searchSalesOrderSelect",saleID:$(this).data("id")},success:function(e){var t="",s=0;$.each(JSON.parse(e),function(e,a){a.sale_id!=$(".salespayment-row").data("id")?(s+=parseFloat(a.sale_total_amount),t+='\n                            <tr class="salespayment-row" data-id="'.concat(a.sale_id,'">\n                                <td>\n                                    <button class="btn btn-danger deleteSalesOrderBtn py-md-3 px-md-4 p-sm-3">\n                                        <i class="fas fa-trash-alt"></i>\n                                    </button>\n                                    <button class="btn btn-secondary viewSalesOrderBtn py-md-3 px-md-4 p-sm-3">\n                                        <i class="fas fa-file-invoice"></i>\n                                    </button>\n                                </td>\n                                <td class="sale_id">').concat(a.sale_id,'</td>\n                                <td class="customer_name">').concat(a.customer_name,'</td>\n                                <td class="sale_salesperson">').concat(a.sale_salesperson,'</td>\n                                <td class="sale_date">').concat(a.sale_date,'</td>\n                                <td class="sale_subtotal">').concat(a.sale_subtotal,'</td>\n                                <td class="sale_discount_header">').concat(a.sale_discount_header,'</td>\n                                <td class="sale_total_amount">').concat(a.sale_total_amount,"</td>\n                            </tr>\n                        ")):s+=parseFloat(a.sale_total_amount)}),0<$("#salespayment-salesorder-bucket").find(".salespayment-noResultText").length&&($("#salespayment-salesorder-bucket").empty(),$("#salespayment-search-salesorder").attr("readonly",!0)),$("#salespayment-salesorder-search").empty().removeClass("border"),$("#salespayment-search-salesorder").val(""),""!=t&&$("#salespayment-salesorder-bucket").append(t),$(".deleteSalesOrderBtn").click(function(){$(this).closest("tr").remove();var e=parseFloat($(this).parent().parent().find(".sale_total_amount").text()),a=parseFloat($("#salespayment_totalCharge").text());$("#salespayment-search-salesorder").attr("readonly",!1),$("#salespayment-total_cost, #salespayment_totalCharge").empty().text((a-e).toFixed(2)),0==$.trim($("#salespayment-salesorder-bucket").html()).length&&$("#salespayment-salesorder-bucket").html('\n                                <tr class="salespayment-noResultText">\n                                    <td colspan="9" class="text-center">\n                                        <h5>No sales order added yet</h5>\n                                    </td>\n                                </tr>\n                            ')}),$("#salespayment_totalCharge, #salespayment-total_cost").empty().text(s.toFixed(2));var a=parseFloat($("#salespayment_amountPaid").text()),n=parseFloat($("#salespayment_totalCharge").text());n<a?$("#salespayment_exchange").empty().text((a-n).toFixed(2)):$("#salespayment_exchange").empty().text("0.00"),$("#salespayment-amount_apply").change(function(){var e=parseFloat($(this).val()).toFixed(2);$(this).val(e),$("#salespayment_amountPaid").empty().text(e);var a=parseFloat($("#salespayment_amountPaid").text()),t=parseFloat($("#salespayment_totalCharge").text());t<a?$("#salespayment_exchange").empty().text((a-t).toFixed(2)):$("#salespayment_exchange").empty().text("0.00")}),l()},error:function(e){p("Failed","Unexpected error occur : "+e)}})}),$("#salespaymentSearchCurrentPageNum").focusout(function(){salespaymentsearchResults(parseInt($(this).val()))})}))},error:function(e){p("Failed","Unexpected error occur : "+e)}})},1e3)):($("#salespayment-salesorder-search").empty().removeClass("border"),s=!1)}function l(){$(".viewSalesOrderBtn").click(function(){$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"viewSalePaymentDetail",sale_id:$(this).parent().parent().data("id")},success:function(e){var a=JSON.parse(e),t="",s=0,n=0;console.log(a),$.each(a[0],function(e,a){$("#salepaymentdetail-sale_id").empty().text(a.sale_id),$("#salepaymentdetail-customer_account").empty().text(a.customer_account),$("#salepaymentdetail-customer_name").empty().text(a.customer_name),$("#salepaymentdetail-sale_salesperson").empty().text(a.sale_salesperson),$("#salepaymentdetail-sale_subtotal").empty().text(a.sale_subtotal),$("#salepaymentdetail-sale_discount_header").empty().text(a.sale_discount_header),$("#salepaymentdetail-sale_total_amount").empty().text(a.sale_total_amount)}),$.each(a[1],function(e,a){"No Result"==a?p("Failed","Could not find any sale order"):(n+=parseFloat(a.amount)*(parseFloat(a.discount)/100),s+=parseFloat(a.price),t+="\n                            <tr>\n                                <td>".concat(a.item_no,"</td>\n                                <td>").concat(a.description,"</td>\n                                <td>").concat(a.qty,"</td>\n                                <td>").concat(a.uom,"</td>\n                                <td>").concat(a.amount,"</td>\n                                <td>").concat(a.discount,"</td>\n                                <td>").concat(a.price,"</td>\n                            </tr>\n                            "))}),$("#salespaymentdetail-item-bucket").empty().html(t),$("#salepaymentdetail-total_discount").empty().text(n.toFixed(2)),$("#salepaymentdetail-total_cost").empty().text(s.toFixed(2)),$("#viewSalesOrderDetailModal").modal("show")},error:function(e){p("Failed","Unexpected error occur : "+e)}})})}function r(a){var e,t;""!=$("#update-salespayment-search-salesorder").val()?(clearTimeout(e),e=setTimeout(function(){$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"salesorderSearch",searchSalesOrder:$("#update-salespayment-search-salesorder").val(),pageNum:a},success:function(e){"No result"==e?1==s&&($("#update-salespayment-salesorder-search").empty().html('\n                                <div class="row">\n                                    <div class="col-6">\n                                        <h5>'.concat(e,'</h5>\n                                    </div>\n                                    <div class="col-6 text-right">\n                                        <a class="btn btn-primary" href="./itemMaintenance.php">Go add new item</a>\n                                    </div>\n                                </div>\n                                ')),s=!1):""==e?($("#update-salespayment-salesorder-search").empty().removeClass("border"),s=!1):(t='\n                            <div class="sticky-top bg-white">\n                                <div class="row px-3 py-2 ">\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <p class="my-auto">Search Result: <span class="font-weight-bold" id="update-salespaymentSearchRowTotal"></span></p>\n                                    </div>\n                                    <div class=" col-6 py-2 py-md-0">\n                                        <div class="d-flex flex-row justify-content-end">\n                                            <p class="my-auto">Page : </p>\n                                            <input type="number" id="update-salespaymentSearchCurrentPageNum" class="form-control w-25 mx-2 my-auto px-2 pageInput" min="1" value="'.concat(a,'">\n                                            <p class="my-auto"> of <span id="update-salespaymentSearchPageTotal"></span></p>\n                                        </div>\n                                    </div>\n                                </div>\n                                <hr class="p-0 m-0">\n                            </div>\n                            <div class="overflow-auto" style="max-height:200px;">\n                            '),$.each(JSON.parse(e),function(e,a){t+='\n                                <a class="update-salespayment-search-results" data-id="'.concat(a.sale_id,'">\n                                    <div class="view overlay  ').concat("Unpaid"==a.payment_status?"":"green lighten-4",'">\n                                        <div class="row px-3 py-2">\n                                            <div class="col-8 d-flex flex-row">\n                                                <h5 class="my-auto">').concat(a.sale_id,'</h5>\n                                                <small class="my-auto px-2 text-muted">').concat(a.customer_name,'</small>\n                                            </div>\n                                            <div class="col-4 d-flex flex-row justify-content-end">\n                                                <strong class="my-auto">Status</strong>\n                                                <p class="my-auto px-1 ').concat("Unpaid"==a.payment_status?"":"text-success",'">').concat(a.payment_status,'</p>\n                                            </div>\n                                            <div class="mask flex-center ').concat("Unpaid"==a.payment_status?"rgba-grey-slight":"rgba-green-strong",'"></div>\n                                        </div>\n                                    </div>\n                                </a>\n                                <hr class="p-0 m-0">\n                                '),t+="</div>",$("#update-salespayment-salesorder-search").empty().html(t),s=!1,$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"salesorderCountRow",searchSalesOrder:$("#update-salespayment-search-salesorder").val()},success:function(e){var a,t;$("#update-salespaymentSearchPageTotal").empty().html(e),a=e,t=Math.ceil(a/10),$("#salespaymentSearchPageTotal").empty().text(t),$("#salespaymentSearchCurrentPageNum").attr("max",t),$("#salespaymentSearchCurrentPageNum").on("input",function(){""==$("#salespaymentSearchCurrentPageNum").val()?console.log("empty item search"):$("#salespaymentSearchCurrentPageNum").val()<t?r($("#salespaymentSearchCurrentPageNum").val()):r(t)})},error:function(e){p("Failed","Unexpected error occur : "+e)}}),$(".update-salespayment-search-results").click(function(){$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"searchSalesOrderSelect",saleID:$(this).data("id")},success:function(e){var t="",s=0;$.each(JSON.parse(e),function(e,a){a.sale_id!=$(".salespayment-row").data("id")?(s+=parseFloat(a.sale_total_amount),t+='\n                            <tr class="update-salespayment-row" data-id="'.concat(a.sale_id,'">\n                                <td>\n                                    <button class="btn btn-danger deleteSalesOrderBtn py-md-3 px-md-4 p-sm-3">\n                                        <i class="fas fa-trash-alt"></i>\n                                    </button>\n                                    <button class="btn btn-secondary viewSalesOrderBtn py-md-3 px-md-4 p-sm-3">\n                                        <i class="fas fa-file-invoice"></i>\n                                    </button>\n                                </td>\n                                <td class="sale_id">').concat(a.sale_id,'</td>\n                                <td class="customer_name">').concat(a.customer_name,'</td>\n                                <td class="sale_salesperson">').concat(a.sale_salesperson,'</td>\n                                <td class="sale_date">').concat(a.sale_date,'</td>\n                                <td class="sale_subtotal">').concat(a.sale_subtotal,'</td>\n                                <td class="sale_discount_header">').concat(a.sale_discount_header,'</td>\n                                <td class="sale_total_amount">').concat(a.sale_total_amount,"</td>\n                            </tr>\n                        ")):s+=parseFloat(a.sale_total_amount)}),0<$("#update-salespayment-salesorder-bucket").find(".update-salespayment-noResultText").length&&($("#update-salespayment-salesorder-bucket").empty(),$("#update-salespayment-search-salesorder").attr("readonly",!0)),$("#update-salespayment-salesorder-search").empty().removeClass("border"),$("#update-salespayment-search-salesorder").val(""),""!=t&&$("#update-salespayment-salesorder-bucket").append(t),$(".deleteSalesOrderBtn").click(function(){$(this).closest("tr").remove();var e=parseFloat($(this).parent().parent().find(".sale_total_amount").text()),a=parseFloat($("#update-salespayment_totalCharge").text());$("#update-salespayment-search-salesorder").attr("readonly",!1),$("#update-salespayment-total_cost, #update-salespayment_totalCharge").empty().text((a-e).toFixed(2)),0==$.trim($("#update-salespayment-salesorder-bucket").html()).length&&$("#update-salespayment-salesorder-bucket").html('\n                                <tr class="update-salespayment-noResultText">\n                                    <td colspan="9" class="text-center">\n                                        <h5>No sales order added yet</h5>\n                                    </td>\n                                </tr>\n                            ')}),$("#update-salespayment_totalCharge, #update-salespayment-total_cost").empty().text(s.toFixed(2));var a=parseFloat($("#update-salespayment_amountPaid").text()),n=parseFloat($("#update-salespayment_totalCharge").text());n<a?$("#update-salespayment_exchange").empty().text((a-n).toFixed(2)):$("#update-salespayment_exchange").empty().text("0.00"),l(),d()},error:function(e){p("Failed","Unexpected error occur : "+e)}})}),$("#update-salespaymentSearchCurrentPageNum").focusout(function(){updateSalespaymentsearchResults(parseInt($(this).val()))})}))},error:function(e){p("Failed","Unexpected error occur : "+e)}})},1e3)):($("#update-salespayment-salesorder-search").empty().removeClass("border"),s=!1)}function d(){$("#update-salespayment-amount_apply").change(function(){var e=parseFloat($(this).val()).toFixed(2);$(this).val(e),$("#update-salespayment_amountPaid").empty().text(e);var a=parseFloat($("#update-salespayment_amountPaid").text()),t=parseFloat($("#update-salespayment_totalCharge").text());t<a?$("#update-salespayment_exchange").empty().text((a-t).toFixed(2)):$("#update-salespayment_exchange").empty().text("0.00")})}function p(e,a){$("#failedToModal").modal("show"),$("#failedModalHeadline").empty().append(e),$("#failedModalBody").empty().append(a)}function m(e,a){$("#successModalHeadline").empty().append(e),$("#successModalBody").empty().append(a),$("#successToModal").modal("show")}function t(){var a;return $.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"countRow"},async:!1,success:function(e){$("#salespayment-rowTotal").empty().append(e),a=e},error:function(e){p("Failed","Unexpected error occur : "+e)}}),a}function u(e){var a=Math.ceil(e/20);return $("#salespayment-pageTotal").empty().text(a),$("#salespayment-currentPageNum").val()>a&&$("#salespayment-currentPageNum").val(a),a}function i(){var e;o=t(),c=u(o),e=0!=$("#salespayment-currentPageNum").val()?$("#salespayment-currentPageNum").val()>c?c:$("#salespayment-currentPageNum").val():1,$("#salespayment-currentPageNum").val(e),$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"viewSalePayment",pageNum:e},success:function(e){"0 results"==e||"No Result"==e?(h("salespayment"),y("salespayment")):(function(e,a){switch(a){case"salespayment":h("salespayment"),$.each(e,function(e,a){$("#salespaymentContent").append('\n                        <tr class="salespayment-row" data-salespayment-id="'.concat(a.sale_payment_id,'">\n                            <th>').concat(++e,'</th>\n                            <td>\n                                <button class="btn btn-warning editSalesPaymentBtn py-md-3 px-md-4 p-sm-3" data-toggle="modal" data-target="#editSalesPaymentModal">\n                                    <i class="fas fa-edit"></i>\n                                </button>\n                                <button class="btn btn-secondary printSalesPaymentBtn py-md-3 px-md-4 p-sm-3" data-toggle="modal" data-target="#printSalesPaymentModal">\n                                    <i class="fas fa-print"></i>\n                                </button>\n                            </td>\n                            <td class="sale_payment_id">').concat(a.sale_payment_id,'</td>\n                            <td class="sale_id_header">').concat(a.sale_id_header,'</td>\n                            <td class="sale_payment_date">').concat(a.sale_payment_date,'</td>\n                            <td class="sale_payment_time">').concat(a.sale_payment_time,'</td>\n                            <td class="payment_method">').concat(a.payment_method,'</td>\n                            <td class="customer_name">').concat(a.customer_name,'</td>\n                            <td class="sale_amount">').concat(a.sale_amount,'</td>\n                            <td class="sale_payment">').concat(a.sale_payment,'</td>\n                            <td class="reference">').concat(a.reference,"</td>\n                        </tr>\n                    "))}),y("salespayment")}}(JSON.parse(e),"salespayment"),$(".editSalesPaymentBtn").click(function(){var e=$(this).parent().parent(),a=e.find(".reference").text(),t=e.find(".payment_method").text(),s=e.find(".sale_payment").text(),n=e.find(".sale_id_header").text();$("#update-salespayment-amount_apply").val(s),$("#update-salespayment-payment_mode").val(t),$("#update-salespayment-reference").val(a),$("#update-salespayment_amountPaid").empty().text(s),$("#update-salespayment_id").val(e.data("salespayment-id")),console.log(n),$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"searchSalesOrderSelect",saleID:n},success:function(e){var t="",s=0;$.each(JSON.parse(e),function(e,a){a.sale_id!=$(".salespayment-row").data("id")?(s+=parseFloat(a.sale_total_amount),t+='\n                                            <tr class="update-salespayment-row" data-id="'.concat(a.sale_id,'">\n                                                <td>\n                                                    <button class="btn btn-danger deleteSalesOrderBtn py-md-3 px-md-4 p-sm-3">\n                                                        <i class="fas fa-trash-alt"></i>\n                                                    </button>\n                                                    <button class="btn btn-secondary viewSalesOrderBtn py-md-3 px-md-4 p-sm-3">\n                                                        <i class="fas fa-file-invoice"></i>\n                                                    </button>\n                                                </td>\n                                                <td class="sale_id">').concat(a.sale_id,'</td>\n                                                <td class="customer_name">').concat(a.customer_name,'</td>\n                                                <td class="sale_salesperson">').concat(a.sale_salesperson,'</td>\n                                                <td class="sale_date">').concat(a.sale_date,'</td>\n                                                <td class="sale_subtotal">').concat(a.sale_subtotal,'</td>\n                                                <td class="sale_discount_header">').concat(a.sale_discount_header,'</td>\n                                                <td class="sale_total_amount">').concat(a.sale_total_amount,"</td>\n                                            </tr>\n                                        ")):s+=parseFloat(a.sale_total_amount)}),0<$("#update-salespayment-salesorder-bucket").find(".update-salespayment-noResultText").length&&($("#update-salespayment-salesorder-bucket").empty(),$("#update-salespayment-search-salesorder").attr("readonly",!0)),$("#update-salespayment-salesorder-search").empty().removeClass("border"),$("#update-salespayment-search-salesorder").val(""),""!=t&&$("#update-salespayment-salesorder-bucket").empty().html(t),$(".deleteSalesOrderBtn").click(function(){$(this).closest("tr").remove();var e=parseFloat($(this).parent().parent().find(".sale_total_amount").text()),a=parseFloat($("#update-salespayment_totalCharge").text());$("#update-salespayment-search-salesorder").attr("readonly",!1),$("#update-salespayment-total_cost, #update-salespayment_totalCharge").empty().text((a-e).toFixed(2)),0==$.trim($("#update-salespayment-salesorder-bucket").html()).length&&$("#update-salespayment-salesorder-bucket").html('\n                                            <tr class="update-salespayment-noResultText">\n                                                <td colspan="9" class="text-center">\n                                                    <h5>No sales order added yet</h5>\n                                                </td>\n                                            </tr>\n                                        ')}),$("#update-salespayment_totalCharge, #update-salespayment-total_cost").empty().text(s.toFixed(2));var a=parseFloat($("#update-salespayment_amountPaid").text()),n=parseFloat($("#update-salespayment_totalCharge").text());n<a?$("#update-salespayment_exchange").empty().text((a-n).toFixed(2)):$("#update-salespayment_exchange").empty().text("0.00"),l(),d()},error:function(e){p("Failed","Unexpected error occur : "+e)}})}),$(".printSalesPaymentBtn").click(function(){$("#print_salepayment_id").val($(this).parent().parent().data("salespayment-id"))}))},failed:function(e){p("Failed","Unexpected error occur : "+e)}})}function y(e){switch(e){case"salespayment":$("#salespaymentTable").DataTable({searching:!1,paginate:!1,lengthChange:!1,info:!1,scrollX:!0,scrollY:"1000px",scrollCollapse:!0}).columns.adjust();$(".dataTables_length").addClass("bs-select")}}function h(e){switch(e){case"salespayment":$("#salespayment-table").empty().append('<table id="salespaymentTable" class="table table-hover table-bordered table_fullwidth text-center" cellspacing="0" >  <thead class="grey lighten-2  ">  <tr>  <th scope="col">#</th>  <th scope="col" class="text-center th-lg">Action</th>  <th scope="col" class="th-lg">Sale Payment ID</th>  <th scope="col" class="th-lg">Sale Header ID</th>  <th scope="col" class="th-lg">Payment Date</th>  <th scope="col" class="th-lg">Payment Time</th>  <th scope="col" class="th-lg">Payment Method</th>  <th scope="col" class="th-lg">Customer Name</th>  <th scope="col" class="th-lg">Sale Amount</th>  <th scope="col" class="th-lg">Sale Payment</th>  <th scope="col" class="th-lg">Reference</th>  </tr>  </thead>  <tbody id="salespaymentContent">  </tbody>  <tfoot class="grey lighten-2">  <tr>  <th scope="col">#</th>  <th scope="col" class="text-center th-lg">Action</th>  <th scope="col" class="th-lg">Sale Payment ID</th>  <th scope="col" class="th-lg">Sale Header ID</th>  <th scope="col" class="th-lg">Payment Date</th>  <th scope="col" class="th-lg">Payment Time</th>  <th scope="col" class="th-lg">Payment Method</th>  <th scope="col" class="th-lg">Customer Name</th>  <th scope="col" class="th-lg">Sale Amount</th>  <th scope="col" class="th-lg">Sale Payment</th>  <th scope="col" class="th-lg">Reference</th>  </tr>  </tfoot>  </table>')}}i(),$("#salespayment-currentPageNum").focusout(function(){i()}),$("#salespayment-search-salesorder").on("keyup",function(){clearTimeout(e),s||($("#salespayment-salesorder-search").empty().addClass("border").html('\n                <div class="d-flex justify-content-center">\n                    <div class="spinner-border" role="status">\n                        <span class="sr-only">Loading...</span>\n                    </div>\n                </div>\n                '),s=!0),$(this).val()?e=setTimeout(function(){n(1)},1e3):($("#salespayment-salesorder-search").empty().removeClass("border"),s=!1)}),$("#update-salespayment-search-salesorder").on("keyup",function(){clearTimeout(void 0),a||($("#update-salespayment-salesorder-search").empty().addClass("border").html('\n                    <div class="d-flex justify-content-center">\n                        <div class="spinner-border" role="status">\n                            <span class="sr-only">Loading...</span>\n                        </div>\n                    </div>\n                    '),a=!0),$(this).val()?timeUpdater=setTimeout(function(){r(1)},1e3):($("#update-salespayment-salesorder-search").empty().removeClass("border"),a=!1)}),$("#addSalesPaymentModalBtn").click(function(){$("#salespayment-amount_apply").val("0.00"),$("#salespayment-payment_mode").val("cash"),$("#salespayment-reference").val(""),$("#salespayment_amountPaid").empty().text("0.00"),$("#salespayment_totalCharge").empty().text("0.00"),$("#salespayment_exchange").empty().text("0.00"),$("#salespayment-search-salesorder").attr("readonly",!1),$("#salespayment-total_cost").empty(),$("#salespayment-salesorder-bucket").empty().html('\n        <tr class="salespayment-noResultText">\n            <td colspan="9" class="text-center">\n                <h5>No sales order added yet</h5>\n            </td>\n        </tr>\n    ')}),$("#addSalesPaymentSubmitBtn").click(function(){var e,a,t,s,n,l;parseFloat($("#salespayment-amount_apply").val())<=0?p("Failed","Current payment amount is 0"):parseFloat($("#salespayment_totalCharge").text())>parseFloat($("#salespayment-amount_apply").val())?p("Failed","Amount paid is not enough to fulfill current charge"):0<$("#salespayment-salesorder-bucket").find(".salespayment-noResultText").length?p("Failed","No sales order added yet"):(e=$("#salespayment-salesorder-bucket").find(".salespayment-row").find(".customer_name").text(),a=$("#salespayment-salesorder-bucket").find(".salespayment-row").data("id"),t=$("#salespayment-payment_mode").val(),s=$("#salespayment_totalCharge").text(),n=$("#salespayment_amountPaid").text(),l=$("#salespayment-reference").val(),$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"addSalePayment",customer_name:e,sale_id:a,payment_method:t,sale_amount:s,sale_payment:n,reference:l},success:function(e){switch(e){case"Some input field is not set.":p("Failed",e);break;case"success add payment":$("#addSalesPaymentModal").modal("hide"),m("Success","Sale Payment is successfully added"),$("#salespayment-table").empty(),$("#salespayment-currentPageNum").val(1),c=u(o),$(".btnSuccess").click(function(){location.reload()})}},error:function(e){p("Failed","Unexpected error occur : "+e)}}))}),$("#editSalesPaymentSubmitBtn").click(function(){var e,a,t,s;parseFloat($("#update-salespayment-amount_apply").val())<=0?p("Failed","Current payment amount is 0"):parseFloat($("#supdate-alespayment_totalCharge").text())>parseFloat($("#update-salespayment-amount_apply").val())?p("Failed","Amount paid is not enough to fulfill current charge"):0<$("#update-salespayment-salesorder-bucket").find(".update-salespayment-noResultText").length?p("Failed","No sales order added yet"):(e=$("#update-salespayment_id").val(),a=$("#update-salespayment-payment_mode").val(),t=$("#update-salespayment-amount_apply").val(),s=$("#update-salespayment-reference").val(),$.ajax({type:"POST",url:"./backend/sale/salePayment.php",data:{postType:"updateSalePayment",sale_payment_id:e,payment_method:a,sale_payment:t,reference:s},success:function(e){switch(e){case"Some input field is not set.":p("Failed",e);break;case"success edit payment":$("#editSalesPaymentModal").modal("hide"),m("Success","Sale Payment is successfully updated"),$("#salespayment-table").empty(),$("#salespayment-currentPageNum").val(1),c=u(o),$(".btnSuccess").click(function(){location.reload()})}},error:function(e){console.log(e),p("Failed","Unexpected error occur : "+e)}}))}),$("#salespayment-amount_apply").change(function(){var e=parseFloat($(this).val()).toFixed(2);$(this).val(e),$("#salespayment_amountPaid").empty().text(e)})});