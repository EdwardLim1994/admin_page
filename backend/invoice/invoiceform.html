<!DOCTYPE html>
<html>
<head>

	<title>Para Operation</title>
	<meta charset="utf-8">
  	<meta name="viewport" content="width=device-width, initial-scale=1">

  	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
</head>
<body>

<form id="fileinfo" enctype="multipart/form-data" method="post" name="fileinfo">
    
    <label><b>for UPDATE, do not change in_account & In_name</b></label>
	<input type="text"  placeholder="in_account" id="in_account" >
    <input type="text"  placeholder="in_name" id="in_name" >
    <input type="text"  placeholder="invoice_num" id="invoice_num" >
    <input type="date"  placeholder="invoice_date" id="invoice_date" >
    <input type="text"  placeholder="invoice_remark" id="invoice_remark" >
    <input type="text"  placeholder="doc_no" id="doc_no" >
    <input type="date"  placeholder="due_date" id="due_date" >
    <input type="number"  placeholder="subtotal_ex" id="subtotal_ex" >
    <input type="number"  placeholder="discount_header" id="discount_header" >
    <input type="number"  placeholder="purchase_tax" id="purchase_tax" >
    <input type="number"  placeholder="tax_percent" id="tax_percent" >
    <input type="number"  placeholder="total_amount" id="total_amount" ><br><br><br>

    <label><b>first item</b></label>
    <input type="text"  placeholder="item_no[]" class="item_no" name="item_no[]">
    <input type="text"  placeholder="description[]" class="description" name="description[]">
    <input type="number"  placeholder="quantity[]" class="quantity" name="quantity[]">
    <input type="text"  placeholder="uom[]" class="uom" name="uom[]">
    <input type="number"  placeholder="price[]" class="price" name="price[]">
    <input type="number"  placeholder="discount[]" class="discount" name="discount[]">
    <input type="number"  placeholder="gr_price[]" class="gr_price" name="gr_price[]">
    <input type="number"  placeholder="gr_price_ex[]" class="gr_price_ex" name="gr_price_ex[]">
    <input type="number"  placeholder="amount[]" class="amount" name="amount[]">
    <input type="number"  placeholder="base_cost[]" class="base_cost" name="base_cost[]">
    <input type="number"  placeholder="new_base_cost[]" class="new_base_cost" name="new_base_cost[]">
    <input type="text"  placeholder="remark[]" class="remark" name="remark[]">
    <input type="text"  placeholder="po[]" class="po" name="po[]">
    <input type="number"  placeholder="min_price[]" class="min_price" name="min_price[]">
    <input type="number"  placeholder="amount_tax[]" class="amount_tax" name="amount_tax[]">
    <input type="number"  placeholder="taxable_amount[]" class="taxable_amount" name="taxable_amount[]"><br><br><br>

    <label><b>second item</b></label>
    <input type="text"  placeholder="item_no[]" class="item_no" name="item_no[]">
    <input type="text"  placeholder="description[]" class="description" name="description[]">
    <input type="number"  placeholder="quantity[]" class="quantity" name="quantity[]">
    <input type="text"  placeholder="uom[]" class="uom" name="uom[]">
    <input type="number"  placeholder="price[]" class="price" name="price[]">
    <input type="number"  placeholder="discount[]" class="discount" name="discount[]">
    <input type="number"  placeholder="gr_price[]" class="gr_price" name="gr_price[]">
    <input type="number"  placeholder="gr_price_ex[]" class="gr_price_ex" name="gr_price_ex[]">
    <input type="number"  placeholder="amount[]" class="amount" name="amount[]">
    <input type="number"  placeholder="base_cost[]" class="base_cost" name="base_cost[]">
    <input type="number"  placeholder="new_base_cost[]" class="new_base_cost" name="new_base_cost[]">
    <input type="text"  placeholder="remark[]" class="remark" name="remark[]">
    <input type="text"  placeholder="po[]" class="po" name="po[]">
    <input type="number"  placeholder="min_price[]" class="min_price" name="min_price[]">
    <input type="number"  placeholder="amount_tax[]" class="amount_tax" name="amount_tax[]">
    <input type="number"  placeholder="taxable_amount[]" class="taxable_amount" name="taxable_amount[]"><br><br><br>



<input type="button" value="Add Data" id="uploadBtn"></input>
<input type="button" value="view data header" id="viewBtn"></input>
<label><b>for UPDATE, DELETE, VIEW fill in invoice_id field</b></label>
<input type="text"  placeholder="invoice_id" id="invoice_id" >
<input type="button" value="view data item detail" id="viewDetail"></input>
<input type="button" value="update data" id="updateBtn"></input>
<input type="button" value="delete data" id="deleteBtn"></input>
<input type="button" value="count data" id="countBtn"></input>
<div id="output"></div>
<div id="viewData"></div>


<div class="search-box">
        <input type="text" autocomplete="off" placeholder="Search country..." />
        <div class="result"></div>
</div>
</form>

</body>

<script type="text/javascript">
	
    $('.search-box input[type="text"]').on("keyup input", function(){
        /* Get input value on change */
        var inputVal = $(this).val();
        var resultDropdown = $(this).siblings(".result");

        var fd = new FormData();
        fd.append('search', inputVal );
        //fd.append('postType', 'searchRow');
        //fd.append('postType', 'searchRowCustomer');
        fd.append('postType', 'searchRowItem');

        if(inputVal.length){
        $.ajax({
            //url: 'invoice.php',  
            url: 'viewCustmrItem.php',  
            type: 'POST',
            data: fd,
            dataType : 'json',
            contentType: 'application/json',
            success:function(data){
                console.log(data);
            },
            cache: false,
            contentType: false,
            processData: false
        });


            /*$.get("item.php", {search: inputVal, postType: searchRow}).done(function(data){
                // Display the returned data in browser
                console.log(data);            });*/
        } else{
            resultDropdown.empty();
        }
    });
    
    // Set search input value on click of result item
    $(document).on("click", ".result p", function(){
        $(this).parents(".search-box").find('input[type="text"]').val($(this).text());
        $(this).parent(".result").empty();
    });

    $('#uploadBtn').on('click', function(){ 

        var fd = new FormData();
        fd.append('in_account', $('#in_account').val() );
        fd.append('in_name', $('#in_name').val() );
        fd.append('invoice_num', $('#invoice_num').val() );
        fd.append('invoice_date', $('#invoice_date').val() );
        fd.append('invoice_remark', $('#invoice_remark').val() );
        fd.append('doc_no', $('#doc_no').val() );
        fd.append('due_date', $('#due_date').val() );
        fd.append('subtotal_ex', $('#subtotal_ex').val() );
        fd.append('discount_header', $('#discount_header').val() );
        fd.append('purchase_tax', $('#purchase_tax').val() );
        fd.append('tax_percent', $('#tax_percent').val() );
        fd.append('total_amount', $('#total_amount').val() );

        a_item_no = document.getElementsByName("item_no[]");
        for (let item_no of a_item_no) { fd.append('item_no[]', item_no.value); }
        a_description = document.getElementsByName("description[]");
        for (let description of a_description) { fd.append('description[]', description.value); }
        a_quantity = document.getElementsByName("quantity[]");
        for (let quantity of a_quantity) { fd.append('quantity[]', quantity.value); }
        a_uom = document.getElementsByName("uom[]");
        for (let uom of a_uom) { fd.append('uom[]', uom.value); }
        a_price = document.getElementsByName("price[]");
        for (let price of a_price) { fd.append('price[]', price.value); }
        a_discount = document.getElementsByName("discount[]");
        for (let discount of a_discount) { fd.append('discount[]', discount.value); }
        a_gr_price = document.getElementsByName("gr_price[]");
        for (let gr_price of a_gr_price) { fd.append('gr_price[]', gr_price.value); }
        a_gr_price_ex = document.getElementsByName("gr_price_ex[]");
        for (let gr_price_ex of a_gr_price_ex) { fd.append('gr_price_ex[]', gr_price_ex.value); }
        a_amount = document.getElementsByName("amount[]");
        for (let amount of a_amount) { fd.append('amount[]', amount.value); }
        a_base_cost = document.getElementsByName("base_cost[]");
        for (let base_cost of a_base_cost) { fd.append('base_cost[]', base_cost.value); }
        a_new_base_cost = document.getElementsByName("new_base_cost[]");
        for (let new_base_cost of a_new_base_cost) { fd.append('new_base_cost[]', new_base_cost.value); }
        a_remark = document.getElementsByName("remark[]");
        for (let remark of a_remark) { fd.append('remark[]', remark.value); }
        a_po = document.getElementsByName("po[]");
        for (let po of a_po) { fd.append('po[]', po.value); }
        a_min_price = document.getElementsByName("min_price[]");
        for (let min_price of a_min_price) { fd.append('min_price[]', min_price.value); }
        a_amount_tax = document.getElementsByName("amount_tax[]");
        for (let amount_tax of a_amount_tax) { fd.append('amount_tax[]', amount_tax.value); }
        a_taxable_amount = document.getElementsByName("taxable_amount[]");
        for (let taxable_amount of a_taxable_amount) { fd.append('taxable_amount[]', taxable_amount.value); }
        
        //serialize input array
        /*fd.append('item_no', $('.item_no').serialize());
        fd.append('description', $('.description').serialize());
        fd.append('quantity', $('.quantity').serialize());
        fd.append('uom', $('.uom').serialize());
        fd.append('price', $('.price').serialize());
        fd.append('discount', $('.discount').serialize());
        fd.append('gr_price', $('.gr_price').serialize());
        fd.append('gr_price_ex', $('.gr_price_ex').serialize());
        fd.append('amount', $('.amount').serialize());
        fd.append('base_cost', $('.base_cost').serialize());
        fd.append('new_base_cost', $('.new_base_cost').serialize());
        fd.append('remark', $('.remark').serialize());
        fd.append('po', $('.po').serialize());
        fd.append('min_price', $('.min_price').serialize());
        fd.append('amount_tax', $('.amount_tax').serialize());
        fd.append('taxable_amount', $('.taxable_amount').serialize());*/

        /*fd.append('item_no', $('.item_no'));
        fd.append('description', $('.description'));
        fd.append('quantity', $('.quantity'));
        fd.append('uom', $('.uom'));
        fd.append('price', $('.price'));
        fd.append('discount', $('.discount'));
        fd.append('gr_price', $('.gr_price'));
        fd.append('gr_price_ex', $('.gr_price_ex'));
        fd.append('amount', $('.amount'));
        fd.append('base_cost', $('.base_cost'));
        fd.append('new_base_cost', $('.new_base_cost'));
        fd.append('remark', $('.remark'));
        fd.append('po', $('.po'));
        fd.append('min_price', $('.min_price'));
        fd.append('amount_tax', $('.amount_tax'));
        fd.append('taxable_amount', $('.taxable_amount'));*/
        
        fd.append('postType', 'add');

        $.ajax({
            url: 'invoice.php',  
            type: 'POST',
            data: fd,
            dataType : 'json',
		    contentType: 'application/json',
            success:function(data){
                //$('#output').html(data);
            },
            cache: false,
            contentType: false,
            processData: false
        });
    });

    $('#countBtn').on('click', function(){

        var fd = new FormData();
        //fd.append('postType', 'countRow');
        //fd.append('postType', 'countRowCustomer');
        fd.append('postType', 'countRowItem');

        $.ajax({
            //url: 'customer.php',  
            url: 'viewCustmrItem.php',  
            type: 'POST',
            data: fd,
            dataType : 'json',
            contentType: 'application/json',
            success:function(data){
                //for(var i; i<data.lenght; i++){
                //}     
            //console.log(data);   
            console.log(data);

            },
            cache: false,
            contentType: false,
            processData: false
        });

    });

    $('#viewBtn').on('click', function(){

		var fd = new FormData();
		//fd.append('postType', 'viewHeader');
        //fd.append('postType', 'viewCustomer');
        fd.append('postType', 'viewItem');

    	$.ajax({
            //url: 'invoice.php',
            url: 'viewCustmrItem.php',   
            type: 'POST',
            data: fd,
            dataType : 'json',
		    contentType: 'application/json',
            success:function(data){
               	//for(var i=0; i<data.lenght; i++){
               		//$('#viewData').append('<img src="itemUpload/'+ data[0].item_picture+'" title="Title of image"><br>')
				//}     
			console.log(data);       


			},
            cache: false,
            contentType: false,
            processData: false
        });

    });

    $('#viewDetail').on('click', function(){

    var fd = new FormData();
    fd.append('postType', 'viewDetail');
    fd.append('invoice_id', $('#invoice_id').val() );

    $.ajax({
        url: 'invoice.php',  
        type: 'POST',
        data: fd,
        dataType : 'json',
        contentType: 'application/json',
        success:function(data){
            //for(var i=0; i<data.lenght; i++){
                //$('#viewData').append('<img src="itemUpload/'+ data[0].item_picture+'" title="Title of image"><br>')
            

            //}     
        console.log(data);       


        },
        cache: false,
        contentType: false,
        processData: false
    });

    });

    $('#updateBtn').on('click', function(){

        var fd = new FormData();
        fd.append('in_account', $('#in_account').val() );
        fd.append('in_name', $('#in_name').val() );
        fd.append('invoice_num', $('#invoice_num').val() );
        fd.append('invoice_date', $('#invoice_date').val() );
        fd.append('invoice_remark', $('#invoice_remark').val() );
        fd.append('doc_no', $('#doc_no').val() );
        fd.append('due_date', $('#due_date').val() );
        fd.append('subtotal_ex', $('#subtotal_ex').val() );
        fd.append('discount_header', $('#discount_header').val() );
        fd.append('purchase_tax', $('#purchase_tax').val() );
        fd.append('tax_percent', $('#tax_percent').val() );
        fd.append('total_amount', $('#total_amount').val() );

        a_item_no = document.getElementsByName("item_no[]");
        for (let item_no of a_item_no) { fd.append('item_no[]', item_no.value); }
        a_description = document.getElementsByName("description[]");
        for (let description of a_description) { fd.append('description[]', description.value); }
        a_quantity = document.getElementsByName("quantity[]");
        for (let quantity of a_quantity) { fd.append('quantity[]', quantity.value); }
        a_uom = document.getElementsByName("uom[]");
        for (let uom of a_uom) { fd.append('uom[]', uom.value); }
        a_price = document.getElementsByName("price[]");
        for (let price of a_price) { fd.append('price[]', price.value); }
        a_discount = document.getElementsByName("discount[]");
        for (let discount of a_discount) { fd.append('discount[]', discount.value); }
        a_gr_price = document.getElementsByName("gr_price[]");
        for (let gr_price of a_gr_price) { fd.append('gr_price[]', gr_price.value); }
        a_gr_price_ex = document.getElementsByName("gr_price_ex[]");
        for (let gr_price_ex of a_gr_price_ex) { fd.append('gr_price_ex[]', gr_price_ex.value); }
        a_amount = document.getElementsByName("amount[]");
        for (let amount of a_amount) { fd.append('amount[]', amount.value); }
        a_base_cost = document.getElementsByName("base_cost[]");
        for (let base_cost of a_base_cost) { fd.append('base_cost[]', base_cost.value); }
        a_new_base_cost = document.getElementsByName("new_base_cost[]");
        for (let new_base_cost of a_new_base_cost) { fd.append('new_base_cost[]', new_base_cost.value); }
        a_remark = document.getElementsByName("remark[]");
        for (let remark of a_remark) { fd.append('remark[]', remark.value); }
        a_po = document.getElementsByName("po[]");
        for (let po of a_po) { fd.append('po[]', po.value); }
        a_min_price = document.getElementsByName("min_price[]");
        for (let min_price of a_min_price) { fd.append('min_price[]', min_price.value); }
        a_amount_tax = document.getElementsByName("amount_tax[]");
        for (let amount_tax of a_amount_tax) { fd.append('amount_tax[]', amount_tax.value); }
        a_taxable_amount = document.getElementsByName("taxable_amount[]");
        for (let taxable_amount of a_taxable_amount) { fd.append('taxable_amount[]', taxable_amount.value); }
        
        fd.append('postType', 'update');
        fd.append('invoice_id', $('#invoice_id').val() );

    	$.ajax({
            url: 'invoice.php',  
            type: 'POST',
            data: fd,
            dataType : 'json',
		    contentType: 'application/json',
            success:function(data){


			},
            cache: false,
            contentType: false,
            processData: false
        });

    });

      $('#deleteBtn').on('click', function(){

		var fd = new FormData();
		fd.append('postType', 'deleteHeader');

		//fd.append('item_id', 1);
        fd.append('invoice_id', $('#invoice_id').val() );

    	$.ajax({
            url: 'invoice.php',  
            type: 'POST',
            data: fd,
            dataType : 'json',
		    contentType: 'application/json',
            success:function(data){


			},
            cache: false,
            contentType: false,
            processData: false
        });

    });
</script>
</html>